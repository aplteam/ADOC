<!DOCTYPE html>
<html lang="en">
<head>
<title>Coverage</title>
<meta charset="utf-8"/>
<style>
@media screen{
    html {background-color: #FFFFF0;}
body {
    font-size: 16px;
    font-family : Verdana, "Bitstream Vera Sans", "DejaVu Sans", Tahoma, Geneva, Arial, Sans-serif;
    margin: 1em;
}
th, td {padding: 5px 10px;}
th {text-align: left;}
h1, h2, h3, h4, h5, h6 {color: #424242;}
h1 {font-size: 22px;}
h2 {font-size: 18px; margin-top: 2em; margin-bottom:0.3em;}
tbody tr:nth-child(even) {background-color: #F0F0F0;}
tbody tr:nth-child(odd) {background-color: #FAFAFA;}
th {background-color: #E6E6E6;color: #424242;}
table {border: silver 1px solid; font-size: 14px;font-family: APLFont, monospace;}
code , code a {font-size: 14px; font-family: APLFont, monospace;}
code.header {
    font-size: 16px; 
    font-family: APLFont, monospace; 
    margin: 1.5em 0.5em 0 0.5em; 
    padding:0;
    display: block;
}
div.code-block {
    border: 1px silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 0.5em 0.5em 0.5em 0.5em;
    padding: 0.5em;
}
div.code-block.missing {
    background-color: #fa605254;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
ul li, ol li {margin: 0.7em 0.2em;}
.float-right {float:right;}
.no-underline {    text-decoration :none;}
.top-links {font-size:20px; padding-left: 0.6em;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5px; padding-top:0; font-size: 9px;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 0.5em; padding: 0.5em;}
}
@media print{@page {size: portrait}
@page {
    margin: 1cm 1cm 1cm 1.75cm;
    @bottom-right {
        content: counter(page) " / " counter(pages);
  }
}
body {
    font: 12pt "Times New Roman", Times, serif;
    line-height: 1.2;
     /* CSS3 filter, at the moment Webkit only. Prefix it for future implementations */
    -webkit-filter: grayscale(100%);
    filter: grayscale(100%); /* future-proof */
}
h1 {font-size: 18pt;}
h2 {font-size: 16pt; margin-top: 10pt; margin-bottom: 3pt;}
th, td {padding: 2pt 3pt;}
th {text-align: left;background-color: #DBDBDB;}
tbody tr:nth-child(odd) {background-color: #EDEDED;}
table {
    color-adjust: exact !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-size: 8pt;
    font-family: APLFont, monospace;
}
div.keep-together {break-inside: avoid; break-before:auto;}
table {border: silver 1pt solid;}
code , code a {font-size: 8pt; font-family: APLFont, monospace;}
code.header {
    font-size: 8pt;
    font-family: APLFont, monospace;
    margin: 7pt 3pt 0 10pt;
    padding:0;
    display: block;
}
div.code-block {
    border: 1pt silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 4pt 4pt 4pt 4pt;
    padding: 4pt;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
a {text-decoration: none;color: black;}
ul li, ol li {margin: 8pt 3pt;}
.no-print {display:none;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5pt; padding-top:0; font-size: 6pt;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 8px; padding: 8px;}
}
</style>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.js"></script>
</head>
<body>
<h1 id="top">Coverage Report</h1>
<p>Watched: 139 fns/opr within <code>#.ADOC.ADOC</code></p>
<p>The test suite was executed once:</p>
<table>
<thead>
<tr><th>Executed at</th><th>APLVersion</th><th>Memory (MB)</th></tr>
</thead>
<tbody>
<tr><td>2023-06-11 19:09:03</td><td>Windows-64 ⋄ 18.2.46943.0 ⋄ W ⋄ Development ⋄ Unicode</td><td>50</td></tr>
</tbody>
</table>
<p>Overall 79% of the testable code is covered.</p>
<p>(Comment lines, empty lines, all <code>:End</code>* lines etc. are ignored)</p>
<p>74 of the fns/opr are 100% covered.</p>
<div id="partly-covered" class="keep-together">
<table id="percent">
<thead>
<tr><th style="text-align:left;">Function/Operator</th><th style="text-align:left;">Lines not executed</th><th style="text-align:left;">Coverage</th><th style="text-align:right;">≢</th></tr>
</thead>
<tbody>
<tr class="uncovered"><td><a href="#listing_1" title="Link to listing">#.ADOC.ADOC.ADOC.get_IncludeReference</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_2" title="Link to listing">#.ADOC.ADOC.ADOC.get_Toc</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_3" title="Link to listing">#.ADOC.ADOC.ADOC.get_Inherit</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_4" title="Link to listing">#.ADOC.ADOC.ADOC.set_IgnorePattern</a></td><td>1, 2, 3</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_5" title="Link to listing">#.ADOC.ADOC.ADOC.set_WithRunningNumbers</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_6" title="Link to listing">#.ADOC.ADOC.ADOC.get_WithRunningNumbers</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_7" title="Link to listing">#.ADOC.ADOC.ADOC.set_FullDocName</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_8" title="Link to listing">#.ADOC.ADOC.ADOC.get_FullDocName</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_9" title="Link to listing">#.ADOC.ADOC.ADOC.set_Creator</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_10" title="Link to listing">#.ADOC.ADOC.ADOC.set_HTML</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_11" title="Link to listing">#.ADOC.ADOC.ADOC.get_HTML</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_12" title="Link to listing">#.ADOC.ADOC.ADOC.set_OutputType</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_13" title="Link to listing">#.ADOC.ADOC.ADOC.get_SubTitles</a></td><td>1</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_14" title="Link to listing">#.ADOC.ADOC.ADOC.set_ignoreCopyright</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_15" title="Link to listing">#.ADOC.ADOC.ADOC.set_ignoreHistory</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_16" title="Link to listing">#.ADOC.ADOC.ADOC.set_ignoreVersion</a></td><td>1, 2</td><td>0</td><td>2</td></tr>
<tr class="uncovered"><td><a href="#listing_17" title="Link to listing">#.ADOC.ADOC.ADOC.make_2</a></td><td>3, 4, 5</td><td>0</td><td>3</td></tr>
<tr class="uncovered"><td><a href="#listing_18" title="Link to listing">#.ADOC.ADOC.ADOC.make_all</a></td><td>5←≢3-6,8</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_19" title="Link to listing">#.ADOC.ADOC.ADOC.ShowDocumentation</a></td><td>12←≢4-10,12-14,16,18</td><td>0</td><td>12</td></tr>
<tr class="uncovered"><td><a href="#listing_20" title="Link to listing">#.ADOC.ADOC.ADOC.Reset</a></td><td>5</td><td>0</td><td>1</td></tr>
<tr class="uncovered"><td><a href="#listing_21" title="Link to listing">#.ADOC.ADOC.ADOC.ProcessAsHtml</a></td><td>14←≢4-11,13-18</td><td>0</td><td>14</td></tr>
<tr class="uncovered"><td><a href="#listing_22" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHTML_ForInterface</a></td><td>15←≢1-7,9-12,14-15,17-18</td><td>0</td><td>15</td></tr>
<tr class="uncovered"><td><a href="#listing_23" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHTML_ForDestructor</a></td><td>11←≢1-5,7-10,12-13</td><td>0</td><td>11</td></tr>
<tr class="uncovered"><td><a href="#listing_24" title="Link to listing">#.ADOC.ADOC.ADOC.MakeAnchor</a></td><td>6←≢4-7,9-10</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_25" title="Link to listing">#.ADOC.ADOC.ADOC.GetMaskForCode</a></td><td>4←≢3-5,7</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_26" title="Link to listing">#.ADOC.ADOC.ADOC.ProcessHtag</a></td><td>6←≢1-6</td><td>0</td><td>6</td></tr>
<tr class="uncovered"><td><a href="#listing_27" title="Link to listing">#.ADOC.ADOC.ADOC.FileBox</a></td><td>18←≢1-4,6-17,19-20</td><td>0</td><td>18</td></tr>
<tr class="uncovered"><td><a href="#listing_28" title="Link to listing">#.ADOC.ADOC.ADOC.CalcNoOfListItems</a></td><td>5←≢6-9,11</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_29" title="Link to listing">#.ADOC.ADOC.ADOC.CompressList</a></td><td>14←≢3-5,7-12,14,16,18-19,21</td><td>0</td><td>14</td></tr>
<tr class="uncovered"><td><a href="#listing_30" title="Link to listing">#.ADOC.ADOC.ADOC.WriteFile</a></td><td>18←≢3-13,15,17-20,22-23</td><td>0</td><td>18</td></tr>
<tr class="uncovered"><td><a href="#listing_31" title="Link to listing">#.ADOC.ADOC.ADOC.Run</a></td><td>8←≢3-9,11</td><td>0</td><td>8</td></tr>
<tr class="uncovered"><td><a href="#listing_32" title="Link to listing">#.ADOC.ADOC.ADOC.ReadAnsiFile</a></td><td>10←≢3-12</td><td>0</td><td>10</td></tr>
<tr class="uncovered"><td><a href="#listing_33" title="Link to listing">#.ADOC.ADOC.ADOC.Compress</a></td><td>7←≢2-8</td><td>0</td><td>7</td></tr>
<tr class="uncovered"><td><a href="#listing_34" title="Link to listing">#.ADOC.ADOC.ADOC.EncodeBlanksForNix</a></td><td>8←≢2-8,11</td><td>0</td><td>8</td></tr>
<tr><td><a href="#listing_35" title="Link to listing">#.ADOC.ADOC.ADOC.CreateTopOfBody</a></td><td>11←≢7-13,15-16,19,24</td><td>48</td><td>21</td></tr>
<tr><td><a href="#listing_36" title="Link to listing">#.ADOC.ADOC.ADOC.ReportEmbeddedClasses</a></td><td>4←≢6-9</td><td>56</td><td>9</td></tr>
<tr><td><a href="#listing_37" title="Link to listing">#.ADOC.ADOC.ADOC.View</a></td><td>7←≢12,20,23-24,26,28-29</td><td>56</td><td>16</td></tr>
<tr><td><a href="#listing_38" title="Link to listing">#.ADOC.ADOC.ADOC.MakeScriptFromNamespace</a></td><td>9←≢12-15,17-19,27,34</td><td>61</td><td>23</td></tr>
<tr><td><a href="#listing_39" title="Link to listing">#.ADOC.ADOC.ADOC.FinaliseHtml</a></td><td>15←≢22,25-26,34-35,37,39-40,42,47-50,58,61</td><td>62</td><td>39</td></tr>
<tr><td><a href="#listing_40" title="Link to listing">#.ADOC.ADOC.ADOC.CreateBody</a></td><td>6←≢6,10-12,14-15</td><td>63</td><td>16</td></tr>
<tr><td><a href="#listing_41" title="Link to listing">#.ADOC.ADOC.ADOC.Analyze</a></td><td>4←≢6-8,17</td><td>71</td><td>14</td></tr>
<tr><td><a href="#listing_42" title="Link to listing">#.ADOC.ADOC.ADOC.RestrictVectorLength</a></td><td>3</td><td>75</td><td>4</td></tr>
<tr><td><a href="#listing_43" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHTML_ForOperator</a></td><td>5←≢10-11,13,15,20</td><td>76</td><td>21</td></tr>
<tr><td><a href="#listing_44" title="Link to listing">#.ADOC.ADOC.ADOC.SaveHtml2File</a></td><td>6, 14</td><td>80</td><td>10</td></tr>
<tr><td><a href="#listing_45" title="Link to listing">#.ADOC.ADOC.ADOC.Browse</a></td><td>5←≢43,56-57,59,70</td><td>85</td><td>34</td></tr>
<tr><td><a href="#listing_46" title="Link to listing">#.ADOC.ADOC.ADOC.Fill_META</a></td><td>14, 29</td><td>87</td><td>15</td></tr>
<tr><td><a href="#listing_47" title="Link to listing">#.ADOC.ADOC.ADOC.CreateTop</a></td><td>5←≢19,22,39,49,52</td><td>87</td><td>38</td></tr>
<tr><td><a href="#listing_48" title="Link to listing">#.ADOC.ADOC.ADOC.ListNonNamespaces</a></td><td>4←≢40-41,45-46</td><td>89</td><td>35</td></tr>
<tr><td><a href="#listing_49" title="Link to listing">#.ADOC.ADOC.ADOC.CreateUpperPartOfHTML_Page</a></td><td>20, 21</td><td>89</td><td>18</td></tr>
<tr><td><a href="#listing_50" title="Link to listing">#.ADOC.ADOC.ADOC.Make</a></td><td>9</td><td>90</td><td>10</td></tr>
<tr><td><a href="#listing_51" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHtml</a></td><td>12, 18</td><td>91</td><td>23</td></tr>
<tr><td><a href="#listing_52" title="Link to listing">#.ADOC.ADOC.ADOC.LoopOverPublicStuff</a></td><td>10, 22</td><td>91</td><td>22</td></tr>
<tr><td><a href="#listing_53" title="Link to listing">#.ADOC.ADOC.ADOC.HandleVersionInHeader</a></td><td>14, 15</td><td>91</td><td>22</td></tr>
<tr><td><a href="#listing_54" title="Link to listing">#.ADOC.ADOC.ADOC.HandleHistoryInHeader</a></td><td>29, 39, 44</td><td>91</td><td>33</td></tr>
<tr><td><a href="#listing_55" title="Link to listing">#.ADOC.ADOC.ADOC.Info</a></td><td>21</td><td>92</td><td>13</td></tr>
<tr><td><a href="#listing_56" title="Link to listing">#.ADOC.ADOC.ADOC.ConvertOrdinaryNamespace2Scripted</a></td><td>8</td><td>92</td><td>12</td></tr>
<tr><td><a href="#listing_57" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHTML_ForProperty</a></td><td>11</td><td>93</td><td>14</td></tr>
<tr><td><a href="#listing_58" title="Link to listing">#.ADOC.ADOC.ADOC.PolishComments</a></td><td>21</td><td>93</td><td>15</td></tr>
<tr><td><a href="#listing_59" title="Link to listing">#.ADOC.ADOC.ADOC.GetBase</a></td><td>12</td><td>93</td><td>14</td></tr>
<tr><td><a href="#listing_60" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHTML_ForField</a></td><td>11</td><td>94</td><td>16</td></tr>
<tr><td><a href="#listing_61" title="Link to listing">#.ADOC.ADOC.ADOC.HandleCopyRightInHeader</a></td><td>19</td><td>94</td><td>16</td></tr>
<tr><td><a href="#listing_62" title="Link to listing">#.ADOC.ADOC.ADOC.AnalyzeProperty</a></td><td>15</td><td>95</td><td>19</td></tr>
<tr><td><a href="#listing_63" title="Link to listing">#.ADOC.ADOC.ADOC.PrepareSubLinks</a></td><td>12</td><td>96</td><td>28</td></tr>
<tr><td><a href="#listing_64" title="Link to listing">#.ADOC.ADOC.ADOC.AnalyzeFns</a></td><td>31, 78</td><td>97</td><td>62</td></tr>
<tr><td><a href="#listing_65" title="Link to listing">#.ADOC.ADOC.ADOC.Analyze_</a></td><td>22, 30</td><td>97</td><td>75</td></tr>
<tr class="fullyCovered"><td><a href="#listing_66" title="Link to listing">#.ADOC.ADOC.ADOC.set_Title</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_67" title="Link to listing">#.ADOC.ADOC.ADOC.get_Title</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_68" title="Link to listing">#.ADOC.ADOC.ADOC.set_IncludeReference</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_69" title="Link to listing">#.ADOC.ADOC.ADOC.set_Toc</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_70" title="Link to listing">#.ADOC.ADOC.ADOC.set_Inherit</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_71" title="Link to listing">#.ADOC.ADOC.ADOC.get_IgnorePattern</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_72" title="Link to listing">#.ADOC.ADOC.ADOC.set_ BrowserPath</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_73" title="Link to listing">#.ADOC.ADOC.ADOC.get_ BrowserPath</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_74" title="Link to listing">#.ADOC.ADOC.ADOC.set_ htmlFinalised</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_75" title="Link to listing">#.ADOC.ADOC.ADOC.get_ htmlFinalised</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_76" title="Link to listing">#.ADOC.ADOC.ADOC.get_Creator</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_77" title="Link to listing">#.ADOC.ADOC.ADOC.set_Meta</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_78" title="Link to listing">#.ADOC.ADOC.ADOC.get_Meta</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_79" title="Link to listing">#.ADOC.ADOC.ADOC.get_OutputType</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_80" title="Link to listing">#.ADOC.ADOC.ADOC.set_SubTitles</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_81" title="Link to listing">#.ADOC.ADOC.ADOC.get_ignoreCopyright</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_82" title="Link to listing">#.ADOC.ADOC.ADOC.get_ignoreHistory</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_83" title="Link to listing">#.ADOC.ADOC.ADOC.get_ignoreVersion</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_84" title="Link to listing">#.ADOC.ADOC.ADOC.set_view</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_85" title="Link to listing">#.ADOC.ADOC.ADOC.get_view</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_86" title="Link to listing">#.ADOC.ADOC.ADOC.Version</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_87" title="Link to listing">#.ADOC.ADOC.ADOC.History</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_88" title="Link to listing">#.ADOC.ADOC.ADOC.make_1</a></td><td></td><td>100</td><td>2</td></tr>
<tr class="fullyCovered"><td><a href="#listing_89" title="Link to listing">#.ADOC.ADOC.ADOC.make_0</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_90" title="Link to listing">#.ADOC.ADOC.ADOC.Init_HTML</a></td><td></td><td>100</td><td>19</td></tr>
<tr class="fullyCovered"><td><a href="#listing_91" title="Link to listing">#.ADOC.ADOC.ADOC.RestoreDefaults</a></td><td></td><td>100</td><td>11</td></tr>
<tr class="fullyCovered"><td><a href="#listing_92" title="Link to listing">#.ADOC.ADOC.ADOC.CreateDocFooter</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_93" title="Link to listing">#.ADOC.ADOC.ADOC.ListNamespace</a></td><td></td><td>100</td><td>9</td></tr>
<tr class="fullyCovered"><td><a href="#listing_94" title="Link to listing">#.ADOC.ADOC.ADOC.CreateBrowseDefaults</a></td><td></td><td>100</td><td>15</td></tr>
<tr class="fullyCovered"><td><a href="#listing_95" title="Link to listing">#.ADOC.ADOC.ADOC.Copyright</a></td><td></td><td>100</td><td>8</td></tr>
<tr class="fullyCovered"><td><a href="#listing_96" title="Link to listing">#.ADOC.ADOC.ADOC.SortPublicStuff</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_97" title="Link to listing">#.ADOC.ADOC.ADOC.ListDfnsAndDops</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_98" title="Link to listing">#.ADOC.ADOC.ADOC.ListCurly</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_99" title="Link to listing">#.ADOC.ADOC.ADOC.ListVariables</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_100" title="Link to listing">#.ADOC.ADOC.ADOC.LoopOverVars</a></td><td></td><td>100</td><td>17</td></tr>
<tr class="fullyCovered"><td><a href="#listing_101" title="Link to listing">#.ADOC.ADOC.ADOC.LoopOverHeader</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_102" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHTML_ForVars</a></td><td></td><td>100</td><td>12</td></tr>
<tr class="fullyCovered"><td><a href="#listing_103" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHTML_ForMethodAndFunction</a></td><td></td><td>100</td><td>25</td></tr>
<tr class="fullyCovered"><td><a href="#listing_104" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHTML_ForInclude</a></td><td></td><td>100</td><td>9</td></tr>
<tr class="fullyCovered"><td><a href="#listing_105" title="Link to listing">#.ADOC.ADOC.ADOC.CreateHTML_ForConstructor</a></td><td></td><td>100</td><td>11</td></tr>
<tr class="fullyCovered"><td><a href="#listing_106" title="Link to listing">#.ADOC.ADOC.ADOC.SortMethods</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_107" title="Link to listing">#.ADOC.ADOC.ADOC.Sort</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_108" title="Link to listing">#.ADOC.ADOC.ADOC.SplitAtLamp</a></td><td></td><td>100</td><td>11</td></tr>
<tr class="fullyCovered"><td><a href="#listing_109" title="Link to listing">#.ADOC.ADOC.ADOC.GetTempFileName</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_110" title="Link to listing">#.ADOC.ADOC.ADOC.ReplaceDoubleBackslashByNewLine</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_111" title="Link to listing">#.ADOC.ADOC.ADOC.PolishMore</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_112" title="Link to listing">#.ADOC.ADOC.ADOC.AnalyzeHeader</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_113" title="Link to listing">#.ADOC.ADOC.ADOC.LookOutForSpecialFunctions</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_114" title="Link to listing">#.ADOC.ADOC.ADOC.AnalyzeField</a></td><td></td><td>100</td><td>17</td></tr>
<tr class="fullyCovered"><td><a href="#listing_115" title="Link to listing">#.ADOC.ADOC.ADOC.LoopOverSource</a></td><td></td><td>100</td><td>33</td></tr>
<tr class="fullyCovered"><td><a href="#listing_116" title="Link to listing">#.ADOC.ADOC.ADOC.AnalyzeResult</a></td><td></td><td>100</td><td>10</td></tr>
<tr class="fullyCovered"><td><a href="#listing_117" title="Link to listing">#.ADOC.ADOC.ADOC.GetPublicDefinitionFrom_NS</a></td><td></td><td>100</td><td>14</td></tr>
<tr class="fullyCovered"><td><a href="#listing_118" title="Link to listing">#.ADOC.ADOC.ADOC.GetNameFromHeader</a></td><td></td><td>100</td><td>17</td></tr>
<tr class="fullyCovered"><td><a href="#listing_119" title="Link to listing">#.ADOC.ADOC.ADOC.GetSyntax</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_120" title="Link to listing">#.ADOC.ADOC.ADOC.ProcessKeywords</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_121" title="Link to listing">#.ADOC.ADOC.ADOC.GetPrintCss</a></td><td></td><td>100</td><td>44</td></tr>
<tr class="fullyCovered"><td><a href="#listing_122" title="Link to listing">#.ADOC.ADOC.ADOC.GetScreenCss</a></td><td></td><td>100</td><td>60</td></tr>
<tr class="fullyCovered"><td><a href="#listing_123" title="Link to listing">#.ADOC.ADOC.ADOC.FindEndOfDfns</a></td><td></td><td>100</td><td>8</td></tr>
<tr class="fullyCovered"><td><a href="#listing_124" title="Link to listing">#.ADOC.ADOC.ADOC.MergeWithDevisor</a></td><td></td><td>100</td><td>16</td></tr>
<tr class="fullyCovered"><td><a href="#listing_125" title="Link to listing">#.ADOC.ADOC.ADOC.GetVarsFrom</a></td><td></td><td>100</td><td>3</td></tr>
<tr class="fullyCovered"><td><a href="#listing_126" title="Link to listing">#.ADOC.ADOC.ADOC.InsertChapterToc</a></td><td></td><td>100</td><td>29</td></tr>
<tr class="fullyCovered"><td><a href="#listing_127" title="Link to listing">#.ADOC.ADOC.ADOC.SortAlphabet</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_128" title="Link to listing">#.ADOC.ADOC.ADOC.GetChapterNo</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_129" title="Link to listing">#.ADOC.ADOC.ADOC.P</a></td><td></td><td>100</td><td>1</td></tr>
<tr class="fullyCovered"><td><a href="#listing_130" title="Link to listing">#.ADOC.ADOC.ADOC.isRef</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_131" title="Link to listing">#.ADOC.ADOC.ADOC.embeddedClassNames</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_132" title="Link to listing">#.ADOC.ADOC.ADOC.addExt</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_133" title="Link to listing">#.ADOC.ADOC.ADOC.verbose</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_134" title="Link to listing">#.ADOC.ADOC.ADOC.convertHeader</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_135" title="Link to listing">#.ADOC.ADOC.ADOC.maxLength</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_136" title="Link to listing">#.ADOC.ADOC.ADOC.vs.Top</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_137" title="Link to listing">#.ADOC.ADOC.ADOC.append</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_138" title="Link to listing">#.ADOC.ADOC.ADOC.wait</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_139" title="Link to listing">#.ADOC.ADOC.ADOC.noSplit</a></td><td></td><td>100</td><td>0</td></tr>
</tbody>
</table>
</div>
<script>
$(document).ready(function() {
    var oTable;
    oTable = $("#percent").DataTable( {
        paging:   false,
        ordering: true,
        info:     true,
        fixedHeader: true,
        order: [2,"asc"],
        dom: "Bft",
        drawCallback: function( settings ) {
             var api = this.api();
             $('.header[id^="listing_"]').next().addBack().css("display","none");
             api.rows( {page:"current"} ).data().each(function(data){
              id = data[0];
              id = id.match(/"(\#.*?)"/);
              if (id){$(id[1]).next().addBack().css("display","block");}
             })
        },      
        buttons: [
        {
            text: "Partly covered (31)",
            titleAttr: "50%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^(?!(0%|100%)).*";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Uncovered (34)",
            titleAttr: "0%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^0%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Fully covered (74)",
            titleAttr: "100%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "100%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "All (139)",
            titleAttr: "all",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = ".";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
    ],
 
        columnDefs: [
            {className: "align-right", targets: [2,3]
            },
            {
                render: function ( data, type, row, meta ) {
                            return data+"%" ;        
                        },
                targets: 2
            }
        ]             
    } );
    oTable.button(0).trigger();

} );    
</script>
<h2>Listings</h2>
<code class="header" id="listing_1">#.ADOC.ADOC.ADOC.get_IncludeReference &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_IncludeReference</code>
<code class="emphasize">→[1]  r←_IncludeReference</code>
</div>
<code class="header" id="listing_2">#.ADOC.ADOC.ADOC.get_Toc &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_Toc</code>
<code class="emphasize">→[1]  r←_Toc</code>
</div>
<code class="header" id="listing_3">#.ADOC.ADOC.ADOC.get_Inherit &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_Inherit</code>
<code class="emphasize">→[1]  r←_Inherit</code>
</div>
<code class="header" id="listing_4">#.ADOC.ADOC.ADOC.set_IgnorePattern &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_IgnorePattern arg</code>
<code class="emphasize">→[1]  (∆EM←'"IgnorePattern" must be simple')⎕SIGNAL 11/⍨~0 1∊⍨≡arg.NewValue</code>
<code class="emphasize">→[2]  (∆EM←'"IgnorePattern" must be a string')⎕SIGNAL 11/⍨~IsChar arg.NewValue</code>
<code class="emphasize">→[3]  _IgnorePattern←arg.NewValue</code>
</div>
<code class="header" id="listing_5">#.ADOC.ADOC.ADOC.set_WithRunningNumbers &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_WithRunningNumbers args</code>
<code class="emphasize">→[1]  _WithRunningNumbers←args.NewValue</code>
</div>
<code class="header" id="listing_6">#.ADOC.ADOC.ADOC.get_WithRunningNumbers &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_WithRunningNumbers</code>
<code class="emphasize">→[1]  r←_WithRunningNumbers</code>
</div>
<code class="header" id="listing_7">#.ADOC.ADOC.ADOC.set_FullDocName &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_FullDocName args</code>
<code class="emphasize">→[1]  _FULL_DOC_NAME←args.NewValue</code>
</div>
<code class="header" id="listing_8">#.ADOC.ADOC.ADOC.get_FullDocName &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_FullDocName</code>
<code class="emphasize">→[1]  r←_FULL_DOC_NAME</code>
</div>
<code class="header" id="listing_9">#.ADOC.ADOC.ADOC.set_Creator &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_Creator args</code>
<code class="emphasize">→[1]  _Creator←args.NewValue</code>
</div>
<code class="header" id="listing_10">#.ADOC.ADOC.ADOC.set_HTML &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_HTML args</code>
<code class="emphasize">→[1]  _HTML←args.NewValue</code>
</div>
<code class="header" id="listing_11">#.ADOC.ADOC.ADOC.get_HTML &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_HTML</code>
<code class="emphasize">→[1]  r←_HTML</code>
</div>
<code class="header" id="listing_12">#.ADOC.ADOC.ADOC.set_OutputType &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_OutputType args</code>
<code class="emphasize">→[1]  (∆EM←'"OutputType" has invalid type; must be either "Web" or "Doc"')⎕SIGNAL 11/⍨~'web' 'doc'∊⍨buffer←⊂⎕C args.NewValue</code>
<code class="emphasize">→[2]  _OutputType←'Web' 'Doc'⊃⍨'web' 'doc'⍳buffer</code>
</div>
<code class="header" id="listing_13">#.ADOC.ADOC.ADOC.get_SubTitles &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_SubTitles</code>
<code class="emphasize">→[1]  r←_SubTitles</code>
</div>
<code class="header" id="listing_14">#.ADOC.ADOC.ADOC.set_ignoreCopyright &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_ignoreCopyright arg</code>
<code class="emphasize">→[1]  (∆EM←'"ignoreCopyright" Must be a Boolean')⎕SIGNAL 11/⍨~arg.NewValue∊0 1</code>
<code class="emphasize">→[2]  _ignoreCopyright←arg.NewValue</code>
</div>
<code class="header" id="listing_15">#.ADOC.ADOC.ADOC.set_ignoreHistory &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_ignoreHistory arg</code>
<code class="emphasize">→[1]  (∆EM←'"ignoreHistory" must be a Boolean')⎕SIGNAL 11/⍨~arg.NewValue∊0 1</code>
<code class="emphasize">→[2]  _ignoreHistory←arg.NewValue</code>
</div>
<code class="header" id="listing_16">#.ADOC.ADOC.ADOC.set_ignoreVersion &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_ignoreVersion arg</code>
<code class="emphasize">→[1]  (∆EM←'"ignoreVersion" must be a Boolean')⎕SIGNAL 11/⍨~arg.NewValue∊0 1</code>
<code class="emphasize">→[2]  _ignoreVersion←arg.NewValue</code>
</div>
<code class="header" id="listing_17">#.ADOC.ADOC.ADOC.make_2 &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> make_2(fullDocName title)</code>
<code> [1]  :Implements Constructor</code>
<code> [2]  :Access Public instance</code>
<code class="emphasize">→[3]  make_0</code>
<code class="emphasize">→[4]  _FULL_DOC_NAME←fullDocName</code>
<code class="emphasize">→[5]  Title←title</code>
</div>
<code class="header" id="listing_18">#.ADOC.ADOC.ADOC.make_all &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  make_all all</code>
<code> [1]   :Implements Constructor</code>
<code> [2]   :Access Public instance</code>
<code class="emphasize">→[3]   :If 0 1∊⍨≡all</code>
<code class="emphasize">→[4]   :AndIf IsChar all</code>
<code class="emphasize">→[5]       Init_HTML</code>
<code class="emphasize">→[6]       _FULL_DOC_NAME←all</code>
<code> [7]   :Else</code>
<code class="emphasize">→[8]       11 ⎕SIGNAL⍨∆EM←'Argument is invalid!'</code>
<code> [9]   :EndIf</code>
</div>
<code class="header" id="listing_19">#.ADOC.ADOC.ADOC.ShowDocumentation &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←ShowDocumentation type</code>
<code> [1]      ⍝ * type=1 shows the same information as ]ADOC -??? (read: ADOC adocs itself)</code>
<code> [2]      ⍝ * type=2 shows the "Advanced" document</code>
<code> [3]   :Access Public Shared</code>
<code class="emphasize">→[4]   'Right argument must be either 1 or 2'⎕SIGNAL 11/⍨~(⊂type)∊1 2</code>
<code class="emphasize">→[5]   :Select ↑∊type</code>
<code class="emphasize">→[6]   :Case 1</code>
<code class="emphasize">→[7]       r←Browse ⎕THIS</code>
<code class="emphasize">→[8]   :Case 2</code>
<code class="emphasize">→[9]       :If 0&lt;##.⎕NC'TatinVars'</code>
<code class="emphasize">→[10]          filename←'file://',##.TatinVars.GetFullPath2AssetsFolder,'/AdvancedADOC.html'</code>
<code> [11]      :Else</code>
<code class="emphasize">→[12]          path←##.##.CiderConfig.HOME</code>
<code class="emphasize">→[13]          cfg←⎕SE.Tatin.ReadPackageConfigFile path</code>
<code class="emphasize">→[14]          filename←'file://',path,'/',cfg.assets,'/AdvancedADOC.html'</code>
<code> [15]      :EndIf</code>
<code class="emphasize">→[16]      P.APLTreeUtils2.GoToWebPage filename</code>
<code> [17]  :Else</code>
<code class="emphasize">→[18]      r←'⍵ must be 1 (ADOC -???) or 2 (for the "Advanced" document'</code>
<code> [19]  :EndSelect</code>
</div>
<code class="header" id="listing_20">#.ADOC.ADOC.ADOC.Reset &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> Reset</code>
<code> [1]     ⍝ Reset all internal data structures.</code>
<code> [2]     ⍝</code>
<code> [3]     ⍝ After having called this method the instance can be reused. HTML only.</code>
<code> [4]  :Access Public Instance</code>
<code class="emphasize">→[5]  Init</code>
</div>
<code class="header" id="listing_21">#.ADOC.ADOC.ADOC.ProcessAsHtml &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  ProcessAsHtml(scripts filename)</code>
<code> [1]        ⍝ Process one or more scripts and write the resulting HTML to "filename"</code>
<code> [2]        ⍝ which defaults (if empty) to the name of the script without `#.` in the current directory.</code>
<code> [3]   :Access Public shared</code>
<code class="emphasize">→[4]   (∆EM←'Please pass references only!')⎕SIGNAL 11/⍨{⍵≡⍕¨⍵}scripts</code>
<code class="emphasize">→[5]   :If 0=≢filename</code>
<code class="emphasize">→[6]       filename←'.html',⍨{⍵↓⍨2×'#.'≡2↑⍵}⍕scripts</code>
<code class="emphasize">→[7]       (key newname)←FileBox''filename('Save ADOC file "',filename,'"')</code>
<code class="emphasize">→[8]       →('OK'≢key)/0</code>
<code class="emphasize">→[9]       filename←newname</code>
<code class="emphasize">→[10]  :ElseIf '/\/'∊⍨¯1↑filename</code>
<code class="emphasize">→[11]      filename,←'.html',⍨{⍵↓⍨2×'#.'≡2↑⍵}⍕scripts</code>
<code> [12]  :EndIf</code>
<code class="emphasize">→[13]  myDoc←⎕NEW ⎕THIS</code>
<code class="emphasize">→[14]  myDoc.FullDocName←filename</code>
<code class="emphasize">→[15]  myDoc.Analyze scripts</code>
<code class="emphasize">→[16]  myDoc.CreateHtml ⍬</code>
<code class="emphasize">→[17]  myDoc.FinaliseHtml ⍬</code>
<code class="emphasize">→[18]  myDoc.SaveHtml2File filename</code>
</div>
<code class="header" id="listing_22">#.ADOC.ADOC.ADOC.CreateHTML_ForInterface &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateHTML_ForInterface(data chapterNo)</code>
<code class="emphasize">→[1]   Body←''</code>
<code class="emphasize">→[2]   firstInterfaceMethod←vs.firstInterfaceMethod</code>
<code class="emphasize">→[3]   :If firstInterfaceMethod</code>
<code class="emphasize">→[4]       Body,←({(MakeBookmark ⍵),('h4 id="',GetChapterNo,':','implementedinterfacemethods"')tag ⍵}('Implemented Interface Method',(1&lt;+/'Method'∘≡¨Get vs.publicStuff)/'s'))</code>
<code class="emphasize">→[5]       methodType←GetSingle data</code>
<code class="emphasize">→[6]       Body,←PrepareSubLinks vs.publicStuff methodType vs.formattedScriptName</code>
<code class="emphasize">→[7]       firstInterfaceMethod←0</code>
<code> [8]   :EndIf</code>
<code class="emphasize">→[9]   Body,←vs.topRef,({(MakeBookmark ⍵),('h5 class="aplname" id="',GetChapterNo,':',('name'GetSingle data),'"')tag ⍵}('name'GetSingle data))</code>
<code class="emphasize">→[10]  Body,←SyntaxHelper'syntax'GetSingle data</code>
<code class="emphasize">→[11]  :If 0≠≢'more'GetSingle data</code>
<code class="emphasize">→[12]      Body,←PolishMore'more'GetSingle data</code>
<code> [13]  :EndIf</code>
<code class="emphasize">→[14]  :If 0≠≢'comments'GetSingle data</code>
<code class="emphasize">→[15]      Body,←PolishComments('comments'GetSingle data)0 0 chapterNo</code>
<code> [16]  :EndIf</code>
<code class="emphasize">→[17]  vs.Body,←Body</code>
<code class="emphasize">→[18]  vs.firstInterfaceMethod←firstInterfaceMethod</code>
</div>
<code class="header" id="listing_23">#.ADOC.ADOC.ADOC.CreateHTML_ForDestructor &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateHTML_ForDestructor data</code>
<code class="emphasize">→[1]   Body←''</code>
<code class="emphasize">→[2]   firstDestructor←vs.firstDestructor</code>
<code class="emphasize">→[3]   :If firstDestructor</code>
<code class="emphasize">→[4]       Body,←vs.topRef,((MakeBookmark'Destructor'),('h4 id="',GetChapterNo,':dtor"')tag'Destructor')</code>
<code class="emphasize">→[5]       firstDestructor←0</code>
<code> [6]   :EndIf</code>
<code class="emphasize">→[7]   Body,←{(MakeBookmark ⍵),'h5 class="aplname"'tag ⍵}GetSingle data</code>
<code class="emphasize">→[8]   Body,←SyntaxHelper'syntax'GetSingle data</code>
<code class="emphasize">→[9]   :If 0≠≢'comments'GetSingle data</code>
<code class="emphasize">→[10]      Body,←PolishComments('comments'GetSingle data)0 0 chapterNo</code>
<code> [11]  :EndIf</code>
<code class="emphasize">→[12]  vs.Body,←Body</code>
<code class="emphasize">→[13]  vs.firstDestructor←firstDestructor</code>
</div>
<code class="header" id="listing_24">#.ADOC.ADOC.ADOC.MakeAnchor &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←MakeAnchor(html pattern)</code>
<code> [1]       ⍝ Look for "pattern" in html and make all occurencies an anchor.</code>
<code> [2]       ⍝ Typically "pattern" is something like "http://x.y.z" or "mailto:x@y.z"</code>
<code> [3]       ⍝ of "file:///foo.txt"; You can prevent this from happening with a leading "!"</code>
<code class="emphasize">→[4]   :If 0≠≢where←⌽{⍵/⍳≢⍵}pattern⍷r←html</code>
<code class="emphasize">→[5]       :For i :In where</code>
<code class="emphasize">→[6]           :If '!'=¯1↑r←(i-1)⌽r</code>
<code class="emphasize">→[7]               r←(-i-2)⌽¯1↓r</code>
<code> [8]           :Else</code>
<code class="emphasize">→[9]               ref←{⍵↑⍨¯1+⌊/⍵⍳'  &lt;'}r</code>
<code class="emphasize">→[10]              r←(-i-1)⌽(('a class="externallink" href="',(ref),'"')tag ref),(≢ref)↓r</code>
<code> [11]          :EndIf</code>
<code> [12]      :EndFor</code>
<code> [13]  :EndIf</code>
</div>
<code class="header" id="listing_25">#.ADOC.ADOC.ADOC.GetMaskForCode &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetMaskForCode txt</code>
<code> [1]     ⍝ Returns a mask (vector of Booleans with zeros for all APL code in ⍵.</code>
<code> [2]     ⍝ Does not fall over odd number of ticks.</code>
<code class="emphasize">→[3]  :If 0&lt;noOf←+/r←txt='`'</code>
<code class="emphasize">→[4]  :AndIf {⍵≠⌊⍵}noOf÷2</code>
<code class="emphasize">→[5]      (¯1↑r)←1</code>
<code> [6]  :EndIf</code>
<code class="emphasize">→[7]  r←r∨≠\r</code>
</div>
<code class="header" id="listing_26">#.ADOC.ADOC.ADOC.ProcessHtag &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ProcessHtag r</code>
<code class="emphasize">→[1]  :If '&lt;h&gt;'≡1 1 0 1/4↑r ⍝ is it an &lt;h{n}&gt;-tag?</code>
<code class="emphasize">→[2]      r←P.APLTreeUtils2.DTB r</code>
<code class="emphasize">→[3]      bm←MakeBookmark{⍵↑⍨¯1+⍵⍳'&lt;'}{⍵↓⍨⍵⍳'&gt;'}r</code>
<code class="emphasize">→[4]  :AndIf '&lt;/h&gt;'≢1 1 1 0 1/¯5↑r</code>
<code class="emphasize">→[5]      level←{2↓¯1↓r↑⍨r⍳'&gt;'}r</code>
<code class="emphasize">→[6]      r,←'&lt;/h',level,'&gt;'</code>
<code> [7]  :EndIf</code>
</div>
<code class="header" id="listing_27">#.ADOC.ADOC.ADOC.FileBox &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (key filename)←FileBox y</code>
<code class="emphasize">→[1]   y←{0 1∊⍨≡⍵:⊂⍵ ⋄ ⍵}y</code>
<code class="emphasize">→[2]   (path filename caption extension mode)←y,(≢y)↓'' '' ''(⊂'*.html' 'ADOC HTML')'write'</code>
<code class="emphasize">→[3]   :If 0=≢path</code>
<code class="emphasize">→[4]       path←,⊃⎕CMD'cd'</code>
<code> [5]   :EndIf</code>
<code class="emphasize">→[6]   ∆←⊂'FileBox'</code>
<code class="emphasize">→[7]   ∆,←⊂'Directory'path</code>
<code class="emphasize">→[8]   ∆,←⊂'File'filename</code>
<code class="emphasize">→[9]   ∆,←⊂'CAPTION'caption</code>
<code class="emphasize">→[10]  ∆,←⊂'EVENT'('FileBoxOK' 'FileBoxCancel')1</code>
<code class="emphasize">→[11]  ∆,←⊂'Style' 'Single'</code>
<code class="emphasize">→[12]  ∆,←⊂'FileMode'mode</code>
<code class="emphasize">→[13]  ∆,←⊂'Filters'extension</code>
<code class="emphasize">→[14]  'FileBoxForm'⎕WC ∆</code>
<code class="emphasize">→[15]  DQ_R←⎕DQ'FileBoxForm'</code>
<code class="emphasize">→[16]  :If 'FileBoxCancel'≡2⊃DQ_R</code>
<code class="emphasize">→[17]      key←'CANCEL'</code>
<code> [18]  :Else</code>
<code class="emphasize">→[19]      key←'OK'</code>
<code class="emphasize">→[20]      filename←3⊃DQ_R</code>
<code> [21]  :EndIf</code>
</div>
<code class="header" id="listing_28">#.ADOC.ADOC.ADOC.CalcNoOfListItems &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  noOf←type CalcNoOfListItems data_</code>
<code> [1]       ⍝ Find out how many items belong to a particular list.</code>
<code> [2]  </code>
<code> [3]       ⍝ Note that lists may be nested (one level only) which</code>
<code> [4]       ⍝ means that an ordered list can live inside an unordered</code>
<code> [5]       ⍝ one and vice versa.</code>
<code class="emphasize">→[6]   :If 0=type</code>
<code class="emphasize">→[7]       noOf←+/∧\∨/(⊃(2↑¨(+/∧\' '=↑data_)↓¨data_))∧.=⍉2 2⍴'1.  '</code>
<code class="emphasize">→[8]   :ElseIf 1=type</code>
<code class="emphasize">→[9]       noOf←+/∧\(↑¨(+/∧\' '=↑data_)↓¨data_)∊'* '</code>
<code> [10]  :Else</code>
<code class="emphasize">→[11]      . ⍝ Huuh?!</code>
<code> [12]  :EndIf</code>
<code> [13] </code>
</div>
<code class="header" id="listing_29">#.ADOC.ADOC.ADOC.CompressList &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←CompressList vtv</code>
<code> [1]        ⍝ Takes a vector of character vectors which is supposed to be a list (ordered or not) and</code>
<code> [2]        ⍝ puts lines together that are not separated by a blank line.</code>
<code class="emphasize">→[3]   lc←⌊/+/∧\' '=⊃vtv         ⍝ Leading chars</code>
<code class="emphasize">→[4]   :If '*'∧.=↑¨lc</code>
<code class="emphasize">→[5]       r←vtv</code>
<code> [6]   :Else</code>
<code class="emphasize">→[7]       r←''</code>
<code class="emphasize">→[8]       :Repeat</code>
<code class="emphasize">→[9]           :If 1&lt;noOf←+/∧\(↑¨lc↓¨vtv)=' '</code>
<code class="emphasize">→[10]              buffer←noOf↑vtv</code>
<code class="emphasize">→[11]              :If 1=noOf</code>
<code class="emphasize">→[12]                  (r[≢r])←⊂((≢r)⊃r),P.APLTreeUtils2.DLB↑buffer</code>
<code> [13]              :Else</code>
<code class="emphasize">→[14]                  (r[≢r])←⊂((≢r)⊃r),↑,/P.APLTreeUtils2.DLB¨buffer</code>
<code> [15]              :EndIf</code>
<code class="emphasize">→[16]              vtv←noOf↓vtv</code>
<code> [17]          :Else</code>
<code class="emphasize">→[18]              r,←⊂1⊃vtv</code>
<code class="emphasize">→[19]              vtv←1↓vtv</code>
<code> [20]          :EndIf</code>
<code class="emphasize">→[21]      :Until 0=≢vtv</code>
<code> [22]  :EndIf</code>
</div>
<code class="header" id="listing_30">#.ADOC.ADOC.ADOC.WriteFile &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {append}WriteFile(filename data)</code>
<code> [1]           ⍝ Write UTF-8 "data" to "filename".</code>
<code> [2]   :Access Public Shared</code>
<code class="emphasize">→[3]   append←{2=⎕NC ⍵:⍎⍵ ⋄ 0}'append'</code>
<code class="emphasize">→[4]   flag←0</code>
<code class="emphasize">→[5]   :Repeat</code>
<code class="emphasize">→[6]       :Trap 19 22</code>
<code class="emphasize">→[7]           fno←filename ⎕NTIE 0 17 ⍝ Open exclusively</code>
<code class="emphasize">→[8]           filename ⎕NERASE fno</code>
<code class="emphasize">→[9]           flag←1</code>
<code class="emphasize">→[10]      :CaseList 19</code>
<code class="emphasize">→[11]          ⎕DL 0.2</code>
<code class="emphasize">→[12]      :Case 22</code>
<code class="emphasize">→[13]          flag←1 ⍝ That's just fine</code>
<code> [14]      :Else</code>
<code class="emphasize">→[15]          ⎕DM ⎕SIGNAL ⎕EN</code>
<code> [16]      :EndTrap</code>
<code class="emphasize">→[17]  :Until flag</code>
<code class="emphasize">→[18]  fno←filename ⎕NCREATE 0</code>
<code class="emphasize">→[19]  :If 160≤⎕DR data</code>
<code class="emphasize">→[20]      data←⎕UCS'UTF-8'⎕UCS data</code>
<code> [21]  :EndIf</code>
<code class="emphasize">→[22]  data ⎕NAPPEND fno</code>
<code class="emphasize">→[23]  ⎕NUNTIE fno</code>
</div>
<code class="header" id="listing_31">#.ADOC.ADOC.ADOC.Run &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {R}←{wait}Run cmd</code>
<code> [1]       ⍝ Starts an application</code>
<code> [2]       ⍝ By default, Run doesn't wait for the app to quit.</code>
<code class="emphasize">→[3]   R←0 ''</code>
<code class="emphasize">→[4]   wait←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'wait'</code>
<code class="emphasize">→[5]   (∆EM←'Invalid left argument: must be a Boolean')⎕SIGNAL 11/⍨~wait∊0 1</code>
<code class="emphasize">→[6]   windowStyle←8 ⍝ is WINDOWSTYLE.NORMAL</code>
<code class="emphasize">→[7]   'wsh'⎕WC'OLEClient' 'WScript.Shell'</code>
<code class="emphasize">→[8]   :Trap 0</code>
<code class="emphasize">→[9]       {}wsh.Run cmd windowStyle wait</code>
<code> [10]  :Else</code>
<code class="emphasize">→[11]      R←1('.'⎕WG'LastError')</code>
<code> [12]  :EndTrap</code>
</div>
<code class="header" id="listing_32">#.ADOC.ADOC.ADOC.ReadAnsiFile &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  R←{noSplit}ReadAnsiFile filename</code>
<code> [1]           ⍝ Read contents as chars. File is tied in shared mode.</code>
<code> [2]   :Access Public Shared</code>
<code class="emphasize">→[3]   noSplit←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'noSplit'</code>
<code class="emphasize">→[4]   No←filename ⎕NTIE 0,66</code>
<code class="emphasize">→[5]   Size←⎕NSIZE No</code>
<code class="emphasize">→[6]   R←⎕NREAD No,80,Size,0</code>
<code class="emphasize">→[7]   ⎕NUNTIE No</code>
<code class="emphasize">→[8]   :If ~noSplit</code>
<code class="emphasize">→[9]       :If 0&lt;+/⎕UCS 13 10⍷R</code>
<code class="emphasize">→[10]          R←P.APLTreeUtils2.Split R</code>
<code class="emphasize">→[11]      :ElseIf 0&lt;+/R=⎕UCS 10</code>
<code class="emphasize">→[12]          R←(⎕UCS 10)P.APLTreeUtils2.Split R</code>
<code> [13]      :EndIf</code>
<code> [14]  :EndIf</code>
</div>
<code class="header" id="listing_33">#.ADOC.ADOC.ADOC.Compress &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Compress vtv</code>
<code> [1]      ⍝ Put together those items in vector of character vectors which end with a " _"</code>
<code class="emphasize">→[2]   r←''</code>
<code class="emphasize">→[3]   :While 0≠≢vtv</code>
<code class="emphasize">→[4]       b←'_'=↑¨¯1↑¨vtv</code>
<code class="emphasize">→[5]       noOf←1++/∧\b</code>
<code class="emphasize">→[6]       buffer←noOf↑vtv</code>
<code class="emphasize">→[7]       vtv←noOf↓vtv</code>
<code class="emphasize">→[8]       r,←⊂{↑,/(¯1↓¨⍵↑⍨¯1+≢⍵),⍵[≢⍵]}buffer</code>
<code> [9]   :EndWhile</code>
</div>
<code class="header" id="listing_34">#.ADOC.ADOC.ADOC.EncodeBlanksForNix &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←EncodeBlanksForNix str</code>
<code> [1]      ⍝ Encode blanks in `str` under Linux and `Mac`</code>
<code class="emphasize">→[2]   :Select P.APLTreeUtils2.GetOperatingSystem ⍬</code>
<code class="emphasize">→[3]   :Case 'Win'</code>
<code class="emphasize">→[4]       r←str</code>
<code class="emphasize">→[5]   :CaseList 'Lin' 'Mac'</code>
<code class="emphasize">→[6]       :If 0&lt;+/b←' '=r←str</code>
<code class="emphasize">→[7]           (b/r)←⊂'\ '</code>
<code class="emphasize">→[8]           r←↑,/r</code>
<code> [9]       :EndIf</code>
<code> [10]  :Else</code>
<code class="emphasize">→[11]      . ⍝ Huuh?!</code>
<code> [12]  :EndSelect</code>
</div>
<code class="header" id="listing_35">#.ADOC.ADOC.ADOC.CreateTopOfBody &mdash; 48%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  CreateTopOfBody dummy</code>
<code> [1]      ⍝ Creates the main toc with links to all chapters and adds</code>
<code> [2]      ⍝ also the main header to the top of the document.</code>
<code> [3]   :Access Public Instance</code>
<code> [4]   html←''</code>
<code> [5]   :If 1&lt;≢_DOCS  ⍝ Then we have a main TOC (several namespaces)</code>
<code> [6]       :If ∨/containers←'Container'∘≡¨2⊃¨_META</code>
<code class="emphasize">→[7]           k←l←1</code>
<code class="emphasize">→[8]           html,←(('h1 ',((0=≢_Title)/'id="topmost"'))tag'Table of Contents'),nl</code>
<code class="emphasize">→[9]           :For chapterNo :In ⍳≢containers</code>
<code class="emphasize">→[10]              :If chapterNo⊃containers</code>
<code class="emphasize">→[11]                  html,←'div'tag(⍕l),' ',('a href="#',GetChapterNo,'"')tag chapterNo⊃_DOCS</code>
<code class="emphasize">→[12]                  l←l+1</code>
<code class="emphasize">→[13]                  k←1</code>
<code> [14]              :Else</code>
<code class="emphasize">→[15]                  html,←'div class="subtoc"'tag(⍕l-1),'.',(⍕k),'. ',('a href="#',GetChapterNo,'"')tag chapterNo⊃_DOCS</code>
<code class="emphasize">→[16]                  k←k+1</code>
<code> [17]              :EndIf</code>
<code> [18]          :EndFor</code>
<code class="emphasize">→[19]          html,←'div'tag'&amp;nbsp;'</code>
<code> [20]      :Else</code>
<code> [21]          :If 0=≢_SubTitles</code>
<code> [22]              html,←'&lt;br /&gt;','ol id="toc"'tag⊃,/'li'∘tag¨_DOCS{('a href="#',⍵,'"')tag ⍺}¨'ch'∘,¨¯4↑¨'0000'∘,¨⍕¨⍳≢_DOCS</code>
<code> [23]          :Else</code>
<code class="emphasize">→[24]              html,←{'&lt;br /&gt;','ol id="toc"'tag⊃,/'li'∘tag¨⍵{('a href="#',⍵,'"')tag ⍺}¨'ch'∘,¨¯4↑¨'0000'∘,¨⍕¨⍳≢⍵}','(≠⊆⊢)_SubTitles</code>
<code> [25]          :EndIf</code>
<code> [26]      :EndIf</code>
<code> [27]      html←'div id="maintoc"'tag html</code>
<code> [28]  :EndIf</code>
<code> [29]  :If 0≠≢_Title</code>
<code> [30]      html←('h1 id="topmost"'tag _Title),nl,html</code>
<code> [31]  :EndIf</code>
<code> [32]  html←('&lt;a id="verytop"&gt;&lt;/a&gt;'),nl,html</code>
<code> [33]  _HTML←html,_HTML</code>
</div>
<code class="header" id="listing_36">#.ADOC.ADOC.ADOC.ReportEmbeddedClasses &mdash; 56%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←ReportEmbeddedClasses refToClass</code>
<code> [1]      ⍝ Looks for classes embedded into `refToClass` and returns a vector of character vectors with names.</code>
<code> [2]   :Access Public Shared</code>
<code> [3]   r←''</code>
<code> [4]   source←{↓⍵⌽⍨+/∧\' '=⍵}⊃⎕SRC refToClass</code>
<code> [5]   :If ∨/bool←':include'Search source</code>
<code class="emphasize">→[6]       buffer←(⍎{⍵↓⍨-'.'⍳⍨⌽⍵}⍕refToClass).{⎕SRC⍎⍵}¨{⍵↑⍨¯1+⌊/⍵⍳' :'}¨P.APLTreeUtils2.DMB¨{(≢':Include ')↓⍵}¨source[⍸bool]</code>
<code class="emphasize">→[7]       buffer←(~¨':namespace'∘Search¨buffer)/¨buffer</code>
<code class="emphasize">→[8]       buffer←(~¨':endnamespace'∘Search¨buffer)/¨buffer</code>
<code class="emphasize">→[9]       source,←⊃,/buffer</code>
<code> [10]  :EndIf</code>
<code> [11]  :If 0≠≢where←1↓{⍵/⍳≢⍵}':class'Search source</code>
<code> [12]      r←{⍵↑⍨¯1+⌊/⍵⍳' :'}¨P.APLTreeUtils2.DMB¨{(≢':class ')↓⍵}¨source[where],¨' '</code>
<code> [13]  :EndIf</code>
</div>
<code class="header" id="listing_37">#.ADOC.ADOC.ADOC.View &mdash; 56%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←View filename</code>
<code> [1]   :Access public</code>
<code> [2]      ⍝ Fires up the default browser or uses the Ride browser to display "filename"</code>
<code> [3]   ⎕WX←1</code>
<code> [4]   r←⍬</code>
<code> [5]   :If 3501⌶⍬ ⍝ Connected to Ride?</code>
<code> [6]  ⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝</code>
<code> [7]  ⍝ This did work in the past, but not anymore...</code>
<code> [8]  ⍝          html←⊃⎕NGET EncodeBlanksForNix filename</code>
<code> [9]  ⍝          title←'&lt;title'{{⍵↑⍨¯1+⍵⍳'&lt;'}⍵↓⍨(⍴⍺)+1⍳⍨⍺⍷⍵}∊html</code>
<code> [10] ⍝          title(3500⌶)∊html</code>
<code> [11] ⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝⍝</code>
<code class="emphasize">→[12]      ⎕←']Open ',filename</code>
<code> [13]  :Else</code>
<code> [14]      :Select P.APLTreeUtils2.GetOperatingSystem ⍬</code>
<code> [15]      :Case 'Win'</code>
<code> [16]          'wsh'⎕WC'OLEClient' 'WScript.Shell'</code>
<code> [17]          :If 0=≢_BrowserPath</code>
<code> [18]              {}wsh.Run filename</code>
<code> [19]          :Else</code>
<code class="emphasize">→[20]              {}wsh.Run('"',(_BrowserPath~'"'),'" ',EncodeBlanksForNix filename)</code>
<code> [21]          :EndIf</code>
<code> [22]      :Case 'Lin'</code>
<code class="emphasize">→[23]          :If 0=≢_BrowserPath</code>
<code class="emphasize">→[24]              {}⎕SH'xdg-open file://',filename,' &amp;'</code>
<code> [25]          :Else</code>
<code class="emphasize">→[26]              {}⎕SH _BrowserPath,' file://',(EncodeBlanksForNix filename),' &amp;'</code>
<code> [27]          :EndIf</code>
<code class="emphasize">→[28]      :Case 'Mac'</code>
<code class="emphasize">→[29]          .</code>
<code> [30]      :EndSelect</code>
<code> [31]  :EndIf</code>
</div>
<code class="header" id="listing_38">#.ADOC.ADOC.ADOC.MakeScriptFromNamespace &mdash; 61%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  script←scriptName MakeScriptFromNamespace name</code>
<code> [1]        ⍝ `scriptname` can be either a reference or a fully qualified name.\\</code>
<code> [2]        ⍝ `name` is the name  of an :Included namespace.\\</code>
<code> [3]        ⍝ The function returns the code for `name`.</code>
<code> [4]   :Access Public Shared</code>
<code> [5]   :If ⍬≡⍴scriptName</code>
<code> [6]       ref←scriptName</code>
<code> [7]       :Trap 6 16</code>
<code> [8]           script←ref.##.{⎕SRC⍎⍵}name</code>
<code> [9]           :Return</code>
<code> [10]      :EndTrap</code>
<code> [11]  :Else</code>
<code class="emphasize">→[12]      ref←⍎{⍵↓⍨-'.'⍳⍨⌽⍵}⍕scriptName</code>
<code class="emphasize">→[13]      :If 0=ref.⎕NC name</code>
<code class="emphasize">→[14]          ∆EM←'Tries to :Include "',name,'" but that does not exist'</code>
<code class="emphasize">→[15]          ∆EM ⎕SIGNAL 999</code>
<code> [16]      :EndIf</code>
<code class="emphasize">→[17]      :Trap 16</code>
<code class="emphasize">→[18]          script←ref.{⎕SRC⍎⍵}name</code>
<code class="emphasize">→[19]          :Return</code>
<code> [20]      :EndTrap</code>
<code> [21]  :EndIf</code>
<code> [22]       ⍝ If we got to this stage, it is obviously an ordinary namespace</code>
<code> [23]  :If 9≠ref.⎕NC⍕name</code>
<code> [24]      ∆EM←'"',(⍕ref),'.',name,'" is not a namespace or does not exist'</code>
<code> [25]      999 ⎕SIGNAL⍨∆EM</code>
<code> [26]  :ElseIf ref.{0::0 ⋄ `⊣⎕SRC⍎⍵}⍕name</code>
<code class="emphasize">→[27]      . ⍝ ???</code>
<code> [28]  :Else</code>
<code> [29]      :With ⍎(⍕ref),'.',⍕name</code>
<code> [30]          :If 0≠≢⎕NL 3</code>
<code> [31]              list←⎕NL-3</code>
<code> [32]              script←,¨⊃,/{⎕IO←1 ⋄ ⎕ML←3 ⋄ {⍵{3.2=⎕NC⊂⍺:⍵ ⋄ (''('∇',1⊃⍵)),(1↓⍵),'∇' '  '}⎕NR ⍵}⍵}¨list</code>
<code> [33]          :Else</code>
<code class="emphasize">→[34]              script←''</code>
<code> [35]          :EndIf</code>
<code> [36]      :EndWith</code>
<code> [37]  :EndIf</code>
<code> [38]  script←(':Namespace ',{⍵↓⍨2×'#.'≡2↑⍵}⍕name)'⍝',script,⊂':EndNamespace'</code>
</div>
<code class="header" id="listing_39">#.ADOC.ADOC.ADOC.FinaliseHtml &mdash; 62%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  FinaliseHtml dummy</code>
<code> [1]      ⍝ Finalise the HTML by adding header, title and meta tags.</code>
<code> [2]      ⍝</code>
<code> [3]      ⍝ It also changes any http:// as well as mailto:// and file:// references</code>
<code> [4]      ⍝ into HTML anchors. After having called this method, the HTML is ready for being saved</code>
<code> [5]      ⍝ on disk. The property flag `htmlFinalised` is therefore set to 1.</code>
<code> [6]   :Access Public Instance</code>
<code> [7]   :If 0≠≢_HTML</code>
<code> [8]       CreateTopOfBody ⍬</code>
<code> [9]       CreateDocFooter ⍬</code>
<code> [10]      :If ~_htmlFinalised</code>
<code> [11]          _HTML←∊_HTML</code>
<code> [12]          html←'body'tag _HTML</code>
<code> [13]          head←''</code>
<code> [14]          head,←'&lt;meta http-equiv="Content-Type" content="text/html;charset=utf-8"/&gt;',nl</code>
<code> [15]          :If 2=⎕NC'Title'</code>
<code> [16]              :If 0=≢Title</code>
<code> [17]                  head,←'title'tag 1⊃1⊃_META</code>
<code> [18]              :Else</code>
<code> [19]                  head,←'title'tag Title</code>
<code> [20]              :EndIf</code>
<code> [21]          :Else</code>
<code class="emphasize">→[22]              head,←'title'tag{1=≢⍵:'ADOC: ',1 1⊃⍵ ⋄ 'ADOC: ',(⍕≢⍵),' scripts'}_META</code>
<code> [23]          :EndIf</code>
<code> [24]          :If 0≠≢path←_CssPath</code>
<code class="emphasize">→[25]              path,←'/'/⍨~(¯1↑path)∊'/\'</code>
<code class="emphasize">→[26]              ((path='\')/path)←'/'</code>
<code> [27]          :EndIf</code>
<code> [28]          addExt←{'.css'≡¯4↑⎕C ⍵:⍵ ⋄ ⍵,'.css'}</code>
<code> [29]          :If _IncludeCss</code>
<code> [30]              :If 0=≢path</code>
<code> [31]                  screenStyles←'style type="text/css" media="screen"'tag(≢nl)↓∊nl∘,¨GetScreenCss</code>
<code> [32]                  printStyles←'style type="text/css" media="print"'tag(≢nl)↓∊nl∘,¨GetPrintCss</code>
<code> [33]              :Else</code>
<code class="emphasize">→[34]                  :Trap 22</code>
<code class="emphasize">→[35]                      screenStyles←'style type="text/css" media="screen"'tag(≢nl)↓∊nl∘,¨ReadAnsiFile path,addExt CssScreen</code>
<code> [36]                  :Else</code>
<code class="emphasize">→[37]                      screenStyles←'style type="text/css" media="screen"'tag(≢nl)↓∊nl∘,¨GetScreenCss</code>
<code> [38]                  :EndTrap</code>
<code class="emphasize">→[39]                  :Trap 22</code>
<code class="emphasize">→[40]                      printStyles←'style type="text/css" media="print"'tag(≢nl)↓∊nl∘,¨ReadAnsiFile path,addExt CssPrint</code>
<code> [41]                  :Else</code>
<code class="emphasize">→[42]                      printStyles←'style type="text/css" media="print"'tag(≢nl)↓∊nl∘,¨GetPrintCss</code>
<code> [43]                  :EndTrap</code>
<code> [44]              :EndIf</code>
<code> [45]              head,←screenStyles,printStyles</code>
<code> [46]          :Else</code>
<code class="emphasize">→[47]              fn←({⍵↓⍨1+-⌊/'\/'⍳⍨⌽⍵}GetTempFileName),addExt CssScreen</code>
<code class="emphasize">→[48]              head,←'&lt;link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="file:///',path,fn,'" /&gt;',nl</code>
<code class="emphasize">→[49]              fn←({⍵↓⍨1+-⌊/'\/'⍳⍨⌽⍵}GetTempFileName),addExt CssPrint</code>
<code class="emphasize">→[50]              head,←'&lt;link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="file:///',path,fn,'" /&gt;',nl</code>
<code> [51]          :EndIf</code>
<code> [52]          head←'head'tag head</code>
<code> [53]          html←'html xmlns="http://www.w3.org/1999/xhtml"'tag head,html</code>
<code> [54]          html,⍨←'&lt;?xml version="1.0" encoding="utf-8"?&gt;',nl,'&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;',nl</code>
<code> [55]          _HTML←html</code>
<code> [56]          _htmlFinalised←1</code>
<code> [57]      :Else</code>
<code class="emphasize">→[58]          11 ⎕SIGNAL⍨∆EM←'HTML is already finalised'</code>
<code> [59]      :EndIf</code>
<code> [60]  :Else</code>
<code class="emphasize">→[61]      11 ⎕SIGNAL⍨∆EM←'No HTML found to be finalised'</code>
<code> [62]  :EndIf</code>
</div>
<code class="header" id="listing_40">#.ADOC.ADOC.ADOC.CreateBody &mdash; 63%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←CreateBody(vs chapterNo)</code>
<code> [1]   tail←vs.devisor{0=≢⍺:⍵ ⋄ ' &amp;lt; ',⍺},{⍵/⍨⍵≢' (Container)'}' (',vs.scriptType,')'</code>
<code> [2]   _WithRunningNumbers←{¯1=⍵:1&lt;≢_META ⋄ ⍵}_WithRunningNumbers</code>
<code> [3]   :If 0=≢vs.subTitle</code>
<code> [4]       title←vs.formattedScriptName</code>
<code> [5]   :Else</code>
<code class="emphasize">→[6]       title←vs.subTitle</code>
<code> [7]   :EndIf</code>
<code> [8]   :If _WithRunningNumbers</code>
<code> [9]       :If vs.isContainer</code>
<code class="emphasize">→[10]          name←('. ',⍨⍕vs.subHeadingCounter),title</code>
<code class="emphasize">→[11]          vs.subHeadingCounter+←1</code>
<code class="emphasize">→[12]          vs.containerCounter←1</code>
<code> [13]      :ElseIf vs.hasContainers</code>
<code class="emphasize">→[14]          name←((⍕vs.subHeadingCounter-1),'.',(⍕vs.containerCounter),' '),title</code>
<code class="emphasize">→[15]          vs.containerCounter+←1</code>
<code> [16]      :Else</code>
<code> [17]          name←('. ',⍨⍕chapterNo),title</code>
<code> [18]      :EndIf</code>
<code> [19]  :Else</code>
<code> [20]      name←vs.formattedScriptName</code>
<code> [21]  :EndIf</code>
<code> [22]  vs.Body←(MakeBookmark name),{('h1 id="',GetChapterNo,'"')tag ⍵}name,tail</code>
</div>
<code class="header" id="listing_41">#.ADOC.ADOC.ADOC.Analyze &mdash; 71%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {embeddedClassNames}Analyze scriptRef</code>
<code> [1]     ⍝ Analyses one or more particular script(s) and appends the result to the `Meta` property.</code>
<code> [2]   :Access Public Instance</code>
<code> [3]   embeddedFlag←0&lt;⎕NC'embeddedClassNames'</code>
<code> [4]   embeddedClassNames←{0=≢⍵:⍵ ⋄ 0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'embeddedClassNames'</code>
<code> [5]   :If 0=≢scriptRef</code>
<code class="emphasize">→[6]       list←#.⍎¨⊂[2]#.⎕NL 9.1 9.4 9.5</code>
<code class="emphasize">→[7]       list/⍨←{16::0 ⋄ tmp←⎕SRC ⍵ ⋄ 1}¨list</code>
<code class="emphasize">→[8]       Analyze_¨list</code>
<code> [9]   :ElseIf 1&lt;≢scriptRef</code>
<code> [10]      Analyze_¨scriptRef</code>
<code> [11]  :ElseIf 0≠≢embeddedClassNames</code>
<code> [12]      embeddedClassNames←{(,∘⊂∘,⍣(0 1∊⍨≡⍵))⍵}embeddedClassNames</code>
<code> [13]      embeddedClassNames Analyze_¨⊂scriptRef</code>
<code> [14]  :Else</code>
<code> [15]      :If 0≠≢embeddedClassNames←Analyze_ scriptRef</code>
<code> [16]      :AndIf embeddedFlag</code>
<code class="emphasize">→[17]          embeddedClassNames Analyze_¨⊂scriptRef</code>
<code> [18]      :EndIf</code>
<code> [19]  :EndIf</code>
</div>
<code class="header" id="listing_42">#.ADOC.ADOC.ADOC.RestrictVectorLength &mdash; 75%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←{maxLength}RestrictVectorLength data</code>
<code> [1]  maxLength←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 80}'maxLength'</code>
<code> [2]  :If 0=1↑0⍴data</code>
<code class="emphasize">→[3]      r←maxLength{⍺&gt;≢⍵:⍵ ⋄ (⍺↑⍵),'...'}⍕data</code>
<code> [4]  :Else</code>
<code> [5]      r←maxLength{⍺&gt;≢⍵:⍵ ⋄ (⍺↑⍵),'...'}data</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_43">#.ADOC.ADOC.ADOC.CreateHTML_ForOperator &mdash; 76%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateHTML_ForOperator(data chapterNo)</code>
<code> [1]   Body←''</code>
<code> [2]   firstOpr←vs.firstOpr</code>
<code> [3]   methodType←'access'GetSingle data</code>
<code> [4]   :If firstOpr                                                        ⍝ this catches the first one. Further group changes are identified by a type change because these are sorted</code>
<code> [5]       type←(GetSingle data),'s'</code>
<code> [6]       Body,←{(MakeBookmark ⍵),('h4 id="',GetChapterNo,':','sharedoperators"')tag ⍵}'Shared Operators'</code>
<code> [7]       Body,←PrepareSubLinks vs.publicStuff type vs.formattedScriptName</code>
<code> [8]       firstOpr←0</code>
<code> [9]   :ElseIf methodType≢'access'GetSingle data</code>
<code class="emphasize">→[10]      :If 'Public'≡'access'GetSingle data</code>
<code class="emphasize">→[11]          Body,←({(MakeBookmark ⍵),('h4 id="',GetChapterNo,':',(⎕C methodType),'operators"')tag ⍵}('Method',(1&lt;+/('Public'∘≡¨'access'Get vs.publicStuff)∧~(Get vs.publicStuff)∊'Constructor' 'Interface Method')/'s'),' from Interface')</code>
<code> [12]      :Else</code>
<code class="emphasize">→[13]          Body,←({(MakeBookmark ⍵),('h4 id="',GetChapterNo,':',(⎕C methodType),'operators"')tag ⍵}('access'GetSingle data),(' Method',(1&lt;+/'Method'∘≡¨↑¨Get publicStuff)/'s'))</code>
<code> [14]      :EndIf</code>
<code class="emphasize">→[15]      Body,←PrepareSubLinks vs.publicStuff methodType vs.formattedScriptName</code>
<code> [16]  :EndIf</code>
<code> [17]  Body,←vs.topRef,({(MakeBookmark ⍵),('h5 class="aplname" id="',GetChapterNo,':',('name'GetSingle data),'"')tag ⍵}('name'GetSingle data))</code>
<code> [18]  Body,←SyntaxHelper'syntax'GetSingle data</code>
<code> [19]  :If 0≠≢'more'GetSingle data</code>
<code class="emphasize">→[20]      Body,←PolishMore'more'GetSingle data</code>
<code> [21]  :EndIf</code>
<code> [22]  :If 0≠≢'comments'GetSingle data</code>
<code> [23]      Body,←PolishComments('comments'GetSingle data)0 0 chapterNo</code>
<code> [24]  :EndIf</code>
<code> [25]  vs.firstOpr←firstOpr</code>
<code> [26]  vs.Body,←Body</code>
</div>
<code class="header" id="listing_44">#.ADOC.ADOC.ADOC.SaveHtml2File &mdash; 80%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {filename}←SaveHtml2File filename</code>
<code> [1]        ⍝ Save the HTML into `filename`.</code>
<code> [2]   :Access public instance</code>
<code> [3]   ⎕WX←1</code>
<code> [4]   :If _htmlFinalised</code>
<code> [5]       :If 0=≢filename←{0=≢⍵:_FULL_DOC_NAME ⋄ ⍵}filename</code>
<code class="emphasize">→[6]           11 ⎕SIGNAL⍨∆EM←'No filename specified'</code>
<code> [7]       :EndIf</code>
<code> [8]       filename,←'.html'/⍨~'.'∊filename</code>
<code> [9]       ((filename='\')/filename)←'/'</code>
<code> [10]      filename←↑,/1 ⎕NPARTS filename</code>
<code> [11]      (⊂_HTML)⎕NPUT filename</code>
<code> [12]      _FULL_DOC_NAME←filename</code>
<code> [13]  :Else</code>
<code class="emphasize">→[14]      11 ⎕SIGNAL⍨∆EM←'HTML is not yet prepared'</code>
<code> [15]  :EndIf</code>
</div>
<code class="header" id="listing_45">#.ADOC.ADOC.ADOC.Browse &mdash; 85%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {filename}←{x}Browse scriptRef</code>
<code> [1]           ⍝ This is the main method when ADOC is used without creating an instance and the documentation</code>
<code> [2]           ⍝ is supposed to be beautified and displayed in a browser.\\</code>
<code> [3]           ⍝ By default, the default browser is used to display the result. The exception is that when</code>
<code> [4]           ⍝ the current session is connected to Ride, then the Ride browser is used.\\</code>
<code> [5]           ⍝ You can change this by setting `BrowserPath` to the full path pointing</code>
<code> [6]           ⍝ to an executable. However, this has no effect when the session is connected to Ride.\\</code>
<code> [7]           ⍝ You can set the following parameters via a parameter space; see `CreateBrowseDefaults` for</code>
<code> [8]           ⍝ how to create a parameter space with default values.\\</code>
<code> [9]           ⍝ Such a parameter space can then be passed as left argument to `Browse`:\\</code>
<code> [10]          ⍝ * BrowserPath</code>
<code> [11]          ⍝ * Title</code>
<code> [12]          ⍝ * IgnorePattern</code>
<code> [13]          ⍝ * Inherit</code>
<code> [14]          ⍝ * embeddedClassesFlag</code>
<code> [15]          ⍝ * ignoreCopyright</code>
<code> [16]          ⍝ * ignoreHistory</code>
<code> [17]          ⍝ * ignoreVersion\\</code>
<code> [18]          ⍝ Note that specifying a parameter via a parameter space does</code>
<code> [19]          ⍝ **not** save the value permanently.\\</code>
<code> [20]          ⍝ The right argument can be a single ref pointing to a class, an interface or a</code>
<code> [21]          ⍝ namespace. It can also be a vector of such references.\\</code>
<code> [22]          ⍝ See [Reference to a script](#) for details.\\</code>
<code> [23]          ⍝ Prior to version 6.0 of ADOC it could also be the name of a function; this is</code>
<code> [24]          ⍝ not supported any more.\\</code>
<code> [25]          ⍝ ## Reference to a script</code>
<code> [26]          ⍝ If `scriptRef` is empty, the formerly created HTML is displayed.\\</code>
<code> [27]          ⍝ Note that in this case the HTML remains untouched. Therefore it can still be used for other purposes.\\</code>
<code> [28]          ⍝ You can pass the name of one or more embedded classes --- classes locally defined</code>
<code> [29]          ⍝ within a class script; see `ADOC` itself as an example --- or embedded namespaces.</code>
<code> [30]          ⍝ You get then a document which contains only these embedded</code>
<code> [31]          ⍝ class(es)/namespace(s).\\</code>
<code> [32]          ⍝ Note that this syntax is available only when a single</code>
<code> [33]          ⍝ script is specified in the right argument.</code>
<code> [34]  :Access Public shared</code>
<code> [35]  ⎕TRAP←(999 'E' '∆EM ⎕signal 11')((0 1000)'N')</code>
<code> [36]  filename←''</code>
<code> [37]  _Title←''</code>
<code> [38]  Init_HTML</code>
<code> [39]  :If 0&lt;⎕NC'x'</code>
<code> [40]      :If 9=⎕NC'x' ⍝ is it a parameter space?</code>
<code> [41]          allowed←CreateBrowseDefaults.∆List[;1]</code>
<code> [42]          :If 0∊bool←(x.⎕NL-2)∊allowed</code>
<code class="emphasize">→[43]              11 ⎕SIGNAL⍨∆EM←'Invalid: ',⊃{⍺,',',⍵}/(~bool)⌿x.⎕NL-2</code>
<code> [44]          :EndIf</code>
<code> [45]          bool←(x.⎕NL-2)∊allowed~⊂'RefToUnicodeFile'</code>
<code> [46]          x.⎕EX(~bool)⌿x.⎕NL 2      ⍝ "RefToUnicodeFile" is deprecated</code>
<code> [47]      :AndIf 0≠≢x.⎕NL 2 9</code>
<code> [48]          ⎕SHADOW¨'_',¨x.⎕NL-2     ⍝ Keep them local - we don't want to overwrite the real fields/props</code>
<code> [49]          ⍎¨GetVarsFrom x</code>
<code> [50]      :Else</code>
<code> [51]          (∆EM←'This syntax is retired; set "embeddedClassesFlag" in a parameter space instead')⎕SIGNAL 11</code>
<code> [52]      :EndIf</code>
<code> [53]  :EndIf</code>
<code> [54] </code>
<code> [55]  :If 0=≢scriptRef</code>
<code class="emphasize">→[56]      :If _htmlFinalised</code>
<code class="emphasize">→[57]          tempFilename←GetTempFileName</code>
<code> [58]      :Else</code>
<code class="emphasize">→[59]          11 ⎕SIGNAL⍨∆EM←'I''m afraid, there is no HTML ready for being displayed'</code>
<code> [60]      :EndIf</code>
<code> [61]  :Else</code>
<code> [62]      'Right argument must be a reference pointing to a class, namespace or interface'⎕SIGNAL 11/⍨~∧/(|⎕NC¨⊂∘⍕¨scriptRef)∊9.1 9.4 9.5</code>
<code> [63] </code>
<code> [64]      Fill_META scriptRef     ⍝ ←←← The work horse!</code>
<code> [65] </code>
<code> [66]      :If 0≠≢_META</code>
<code> [67]          _WithRunningNumbers←{¯1=⍵:1&lt;≢_META ⋄ ⍵}_WithRunningNumbers</code>
<code> [68]          CreateHtml ⍬</code>
<code> [69]          :If 0=≢_HTML</code>
<code class="emphasize">→[70]              ⎕←'Nothing found'</code>
<code> [71]          :Else</code>
<code> [72]              FinaliseHtml ⍬</code>
<code> [73]              _Filename←(¯4↓P.FilesAndDirs.GetTempFilename2''),'.html'</code>
<code> [74]              SaveHtml2File _Filename</code>
<code> [75]          :EndIf</code>
<code> [76]          filename←_Filename</code>
<code> [77]      :EndIf</code>
<code> [78]  :EndIf</code>
<code> [79]  :If 0≠≢filename</code>
<code> [80]  :AndIf view</code>
<code> [81]      View filename</code>
<code> [82]  :EndIf</code>
<code> [83]  _embeddedClassName←''</code>
</div>
<code class="header" id="listing_46">#.ADOC.ADOC.ADOC.Fill_META &mdash; 87%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←Fill_META list</code>
<code> [1]      ⍝ Runs a loop on all items in `list` wich can be a single ref or the fully qualified name</code>
<code> [2]      ⍝ of a function or a vector (and mixture) of both. Refs are pointing to classes, interfaces</code>
<code> [3]      ⍝ or namespaces while fully qualified names are special cases were a single function in an</code>
<code> [4]      ⍝ ordinary namespace is expected to carry comments that represent the documentation.</code>
<code> [5]      ⍝</code>
<code> [6]      ⍝ This function (and its sub-functions) assemble a variable _META with contains for every</code>
<code> [7]      ⍝ single "thing" (method, field, function, operator, variable, depending on the source to be</code>
<code> [8]      ⍝ investigated) all information ADOC is supposed to show in one way or another. Later from</code>
<code> [9]      ⍝ this a list (`Info`) or HTML output (`Browse`) is generated</code>
<code> [10]  r←⍬</code>
<code> [11]  isRef←{⍵≢⍕⍵}</code>
<code> [12]  :If 2&gt;≡list</code>
<code> [13]  :AndIf ~isRef list</code>
<code class="emphasize">→[14]      list←,⊂list</code>
<code> [15]  :EndIf</code>
<code> [16]  :For this :In list</code>
<code> [17]      :If isRef this</code>
<code> [18]          scriptRef←this</code>
<code> [19]          :If _embeddedClassesFlag</code>
<code> [20]          :AndIf 0=≢_embeddedClassNames</code>
<code> [21]              _embeddedClassNames←ReportEmbeddedClasses scriptRef</code>
<code> [22]          :EndIf</code>
<code> [23]          :If 0=≢_embeddedClassNames</code>
<code> [24]              Analyze scriptRef</code>
<code> [25]          :Else</code>
<code> [26]              _embeddedClassNames Analyze scriptRef</code>
<code> [27]          :EndIf</code>
<code> [28]      :Else</code>
<code class="emphasize">→[29]          ⎕←'Huuh?! What''s that: ',this</code>
<code> [30]      :EndIf</code>
<code> [31]  :EndFor</code>
</div>
<code class="header" id="listing_47">#.ADOC.ADOC.ADOC.CreateTop &mdash; 87%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateTop(noOfClasses chapterNo)</code>
<code> [1]       ⍝ Create the top part of the HTML page (title, toc) and the links</code>
<code> [2]   :If _IncludeReference</code>
<code> [3]   :AndIf {0=⎕NC ⍵:1 ⋄ OutputType≡'Web'}'OutputType' ⍝ is it an instance?</code>
<code> [4]       vs.topRef←'&lt;a name="topmost"&gt;&lt;/a&gt;'</code>
<code> [5]       :If 1&lt;noOfClasses</code>
<code> [6]           vs.topRef,←'Go to: ',('a href="#',GetChapterNo,'"')tag'chapter'</code>
<code> [7]           vs.topRef←'div class="goto"'tag vs.topRef,' | ',('a href="#verytop"')tag'top'</code>
<code> [8]       :Else</code>
<code> [9]           vs.topRef,←'div class="goto"'tag'Go to: ',('a href="#verytop"')tag'top'</code>
<code> [10]      :EndIf</code>
<code> [11]      vs.topLinks←0 2⍴''</code>
<code> [12]      :If 0&lt;≢vs.publicStuff</code>
<code> [13]          bool←2=↑∘⍴∘⍴¨vs.publicStuff</code>
<code> [14]          types←Get bool/vs.publicStuff</code>
<code> [15]          :If types∊⍨⊂'Constructor'</code>
<code> [16]              vs.topLinks⍪←'ctor'(('a href="#',GetChapterNo,':ctor"')tag'Constructors')</code>
<code> [17]          :EndIf</code>
<code> [18]          :If types∊⍨⊂'Destructor'</code>
<code class="emphasize">→[19]              vs.topLinks⍪←'dtor'(('a href="#',GetChapterNo,':dtor"')tag'Destructors')</code>
<code> [20]          :EndIf</code>
<code> [21]          :If types∊⍨⊂'Interface'</code>
<code class="emphasize">→[22]              vs.topLinks⍪←'interface'(('a href="#',GetChapterNo,':infc"')tag'Interfaces')</code>
<code> [23]          :EndIf</code>
<code> [24]          :If types∊⍨⊂'Property'</code>
<code> [25]              vs.topLinks⍪←'properties'(('a href="#',GetChapterNo,':props"')tag'Properties')</code>
<code> [26]          :EndIf</code>
<code> [27]          :If types∊⍨⊂'Field'</code>
<code> [28]              vs.topLinks⍪←'fields'(('a href="#',GetChapterNo,':fields"')tag'Fields')</code>
<code> [29]          :EndIf</code>
<code> [30]          :If types∊⍨⊂'Method'</code>
<code> [31]              publicTypes←'access'Get(bool/vs.publicStuff)/⍨types≡¨⊂'Method'</code>
<code> [32]              :If publicTypes∊⍨⊂'Instance'</code>
<code> [33]                  vs.topLinks⍪←'instancemethods'(('a href="#',GetChapterNo,':instancemethods"')tag'Instance Methods')</code>
<code> [34]              :EndIf</code>
<code> [35]              :If publicTypes∊⍨⊂'Shared'</code>
<code> [36]                  vs.topLinks⍪←'sharedmethods'(('a href="#',GetChapterNo,':sharedmethods"')tag'Shared Methods')</code>
<code> [37]              :EndIf</code>
<code> [38]              :If publicTypes∊⍨⊂'Public'</code>
<code class="emphasize">→[39]                  vs.topLinks⍪←'publicmethods'(('a href="#',GetChapterNo,':publicmethods"')tag'Interface Methods')</code>
<code> [40]              :EndIf</code>
<code> [41]          :EndIf</code>
<code> [42]          :If types∊⍨⊂'Function'</code>
<code> [43]              vs.topLinks⍪←'sharedmethods'(('a href="#',GetChapterNo,':sharedmethods"')tag'Shared Methods')</code>
<code> [44]          :EndIf</code>
<code> [45]          :If types∊⍨⊂'Operator'</code>
<code> [46]              vs.topLinks⍪←'sharedoperators'(('a href="#',GetChapterNo,':sharedoperators"')tag'Shared Operators')</code>
<code> [47]          :EndIf</code>
<code> [48]          :If types∊⍨⊂'Interface Method'</code>
<code class="emphasize">→[49]              vs.topLinks⍪←'implementedinterfacemethods'(('a href="#',GetChapterNo,':implementedinterfacemethods"')tag'Implemented Interface(s)')</code>
<code> [50]          :EndIf</code>
<code> [51]          :If types∊⍨⊂'Destructor'</code>
<code class="emphasize">→[52]              vs.topLinks,←⊂'a href="#',GetChapterNo,':dtor"'tag'Destructor'</code>
<code> [53]          :EndIf</code>
<code> [54]      :EndIf</code>
<code> [55]  :Else</code>
<code> [56]      vs.(topRef topLinks)←⊂⍬</code>
<code> [57]  :EndIf</code>
</div>
<code class="header" id="listing_48">#.ADOC.ADOC.ADOC.ListNonNamespaces &mdash; 89%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←verbose ListNonNamespaces data</code>
<code> [1]   r←''</code>
<code> [2]   nl←,⎕UCS 13</code>
<code> [3]   :If 1∊bool←'Constructor'∘≡¨Get data</code>
<code> [4]   :AndIf 0≠≢buffer←'syntax'Get bool/data</code>
<code> [5]       r,←nl,'Constructors:'</code>
<code> [6]       r,←⊃,/nl,¨'  '∘,¨'syntax'Get bool/data</code>
<code> [7]   :EndIf</code>
<code> [8]   :If 0≠≢buffer←('Property'∘≡¨Get data)⌿data</code>
<code> [9]       :If 0&lt;+/bool←'Instance'∘≡¨'access'Get buffer</code>
<code> [10]          r,←nl,'Instance Properties:'</code>
<code> [11]          keywords←ProcessKeywords bool/buffer</code>
<code> [12]          r,←⊃,/nl,¨'  '∘,¨('name'Get bool/buffer),¨keywords</code>
<code> [13]      :EndIf</code>
<code> [14]      :If 0&lt;+/bool←~bool</code>
<code> [15]          r,←nl,'Shared Properties:'</code>
<code> [16]          keywords←ProcessKeywords bool/buffer</code>
<code> [17]          r,←⊃,/nl,¨'  '∘,¨('name'Get bool/buffer),¨keywords</code>
<code> [18]      :EndIf</code>
<code> [19]  :EndIf</code>
<code> [20]  :If 0≠≢buffer←data/⍨'Field'∘≡¨Get data</code>
<code> [21]      :If 0&lt;+/bool←'Instance'∘≡¨'access'Get buffer</code>
<code> [22]          r,←nl,'Instance Fields:'</code>
<code> [23]          r,←⊃,/nl,¨'  '∘,¨{⍵↓⍨+/∧\' '=⍵}¨'readonly'∘{∨/⍺⍷⎕C ⍵:(' (',⍺,')'),⍨⍵ ⋄ ⍵}¨'name'Get bool/buffer</code>
<code> [24]      :EndIf</code>
<code> [25]      :If 0&lt;+/bool←~bool</code>
<code> [26]          r,←nl,'Shared Fields:'</code>
<code> [27]          r,←⊃,/nl,¨'  '∘,¨'name'Get bool/buffer</code>
<code> [28]      :EndIf</code>
<code> [29]  :EndIf</code>
<code> [30]  :If 0≠≢buffer←data/⍨'Method'∘≡¨Get data</code>
<code> [31]      :If 0&lt;+/bool←'Instance'∘≡¨'access'Get buffer</code>
<code> [32]          r,←nl,'Instance Methods:'</code>
<code> [33]          r,←⊃,/nl,¨'  '∘,¨((1+verbose)⊃'name' 'syntax')Get bool/buffer</code>
<code> [34]      :EndIf</code>
<code> [35]      :If 0&lt;+/bool←'Shared'∘≡¨'access'Get buffer</code>
<code> [36]          r,←nl,'Shared Methods:'</code>
<code> [37]          r,←⊃,/nl,¨'  '∘,¨((1+verbose)⊃'name' 'syntax')Get bool/buffer</code>
<code> [38]      :EndIf</code>
<code> [39]      :If 0&lt;+/bool←'Public'∘≡¨'access'Get buffer ⍝ True if interface</code>
<code class="emphasize">→[40]          r,←nl,'Methods (from Interface):'</code>
<code class="emphasize">→[41]          r,←⊃,/nl,¨'  '∘,¨((1+verbose)⊃'name' 'syntax')Get bool/buffer</code>
<code> [42]      :EndIf</code>
<code> [43]  :EndIf</code>
<code> [44]  :If 0≠≢buffer←data/⍨'Interface Method'∘≡¨Get data</code>
<code class="emphasize">→[45]      r,←nl,'Implemented Interface(s):'</code>
<code class="emphasize">→[46]      r,←⊃,/nl,¨'  '∘,¨((1+verbose)⊃'name' 'syntax')Get buffer</code>
<code> [47]  :EndIf</code>
</div>
<code class="header" id="listing_49">#.ADOC.ADOC.ADOC.CreateUpperPartOfHTML_Page &mdash; 89%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateUpperPartOfHTML_Page chapterNo</code>
<code> [1]      ⍝ Implicit argument: `_META`.</code>
<code> [2]   vs.(formattedScriptName scriptType devisor header publicStuff require)←chapterNo⊃_META</code>
<code> [3]   vs.isContainer←'Container'≡chapterNo 2⊃_META</code>
<code> [4]   :If 1=chapterNo</code>
<code> [5]       vs.TopMostRefId←vs.formattedScriptName</code>
<code> [6]   :EndIf</code>
<code> [7]   vs.(Top Body)←⊂⍬</code>
<code> [8]   vs←vs CreateTop(≢_META)chapterNo</code>
<code> [9]   vs←vs LoopOverHeader chapterNo</code>
<code> [10]  vs.hasLeadingComments←0≠≢vs.Top</code>
<code> [11]  vs←InsertChapterToc vs</code>
<code> [12]  (vs)←CreateBody(vs chapterNo)</code>
<code> [13]  vs.Body,←vs.Top</code>
<code> [14]  :If _IncludeReference</code>
<code> [15]      :If vs.hasLeadingComments</code>
<code> [16]      :AndIf 0≠≢vs.publicStuff</code>
<code> [17]          vs.Body,←vs.topRef,{(MakeBookmark ⍵),'&lt;h3 id="',GetChapterNo,'_tocref"&gt;',⍵,'&lt;/h3&gt;',nl}'Reference'</code>
<code> [18]      :EndIf</code>
<code> [19]      :If 0≠≢∊vs.require</code>
<code class="emphasize">→[20]          vs.Body,←(MakeBookmark'Requires'),('h4 id="',GetChapterNo,':require"')tag'Requires'</code>
<code class="emphasize">→[21]          vs.Body,←⊃,/{(MakeBookmark ⍵),'h5 class="aplname"'tag ⍵}¨vs.require</code>
<code> [22]      :EndIf</code>
<code> [23]  :EndIf</code>
</div>
<code class="header" id="listing_50">#.ADOC.ADOC.ADOC.Make &mdash; 90%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {filename}←Make y</code>
<code> [1]      ⍝ Instance-equivalent of `ProcessAsHtml`. After having instantiated `ADOC` you</code>
<code> [2]      ⍝ can set properties/fields to make `ADOC` fit your needs. Then you can call</code>
<code> [3]      ⍝ `Make` to create the final document without further action.</code>
<code> [4]   :Access Public Instance</code>
<code> [5]   isRef←{⍵≢⍕⍵}y</code>
<code> [6]   :If isRef</code>
<code> [7]       Analyze y</code>
<code> [8]   :Else</code>
<code class="emphasize">→[9]       (∆EM←'Invalid right argument')⎕SIGNAL 11</code>
<code> [10]  :EndIf</code>
<code> [11]  CreateHtml ⍬</code>
<code> [12]  FinaliseHtml ⍬</code>
<code> [13]  :If 0=≢_FULL_DOC_NAME</code>
<code> [14]      tempFilename←{'html',⍨¯3↓⍵}GetTempFileName</code>
<code> [15]  :Else</code>
<code> [16]      tempFilename←_FULL_DOC_NAME</code>
<code> [17]  :EndIf</code>
<code> [18]  filename←SaveHtml2File tempFilename</code>
</div>
<code class="header" id="listing_51">#.ADOC.ADOC.ADOC.CreateHtml &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←CreateHtml dummy</code>
<code> [1]      ⍝ Create `_HTML` from `_META`.</code>
<code> [2]   r←⍬</code>
<code> [3]   :Access Public Instance</code>
<code> [4]   :If 0&lt;≢_META</code>
<code> [5]       vs←⎕NS''</code>
<code> [6]       vs.hasContainers←∨/'Container'∘≡¨2⊃¨_META</code>
<code> [7]       vs.containerCounter←1</code>
<code> [8]       vs.subHeadingCounter←1     ⍝ In case of containers</code>
<code> [9]       :If 0=≢_SubTitles</code>
<code> [10]          subTitles←''</code>
<code> [11]      :Else</code>
<code class="emphasize">→[12]          subTitles←','(≠⊆⊢)_SubTitles</code>
<code> [13]      :EndIf</code>
<code> [14]      :For chapterNo :In ⍳≢_META</code>
<code> [15]          :If 0=≢subTitles</code>
<code> [16]              vs.subTitle←''</code>
<code> [17]          :Else</code>
<code class="emphasize">→[18]              vs.subTitle←chapterNo⊃subTitles</code>
<code> [19]          :EndIf</code>
<code> [20]          vs←vs CreateUpperPartOfHTML_Page chapterNo</code>
<code> [21]          :If _IncludeReference</code>
<code> [22]              vs.(firstIncludes firstConstructor firstDestructor firstProperty firstField firstInterface)←1</code>
<code> [23]              vs.(firstInstanceMethod firstSharedMethod firstInterfaceMethod firstOpr firstVars)←1</code>
<code> [24]              vs.methodType←''                     ⍝ Will become either "Instance" or "Shared"</code>
<code> [25]              vs.publicStuff←SortPublicStuff vs.publicStuff</code>
<code> [26]              vs←vs LoopOverPublicStuff chapterNo</code>
<code> [27]              _DOCS,←⊂vs.formattedScriptName</code>
<code> [28]          :EndIf</code>
<code> [29]          vs.Body←'div class="content"'tag vs.Body</code>
<code> [30]          _HTML,←⊂vs.Body</code>
<code> [31]      :EndFor</code>
<code> [32]  :EndIf</code>
</div>
<code class="header" id="listing_52">#.ADOC.ADOC.ADOC.LoopOverPublicStuff &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs LoopOverPublicStuff chapterNo</code>
<code> [1]   :For thisStuff :In vs.publicStuff</code>
<code> [2]       {⍵:.}1≠≡vs.Body                                                       ⍝ Internal test case - don't remove!</code>
<code> [3]       thisType←GetSingle thisStuff</code>
<code> [4]       :Select thisType</code>
<code> [5]       :Case 'Include'</code>
<code> [6]           vs←CreateHTML_ForInclude vs</code>
<code> [7]       :Case 'Constructor'</code>
<code> [8]           vs←vs CreateHTML_ForConstructor thisStuff chapterNo</code>
<code> [9]       :Case 'Destructor'</code>
<code class="emphasize">→[10]          vs←vs CreateHTML_ForDestructor thisStuff</code>
<code> [11]      :Case 'Property'</code>
<code> [12]          vs←vs CreateHTML_ForProperty thisStuff chapterNo</code>
<code> [13]      :Case 'Field'</code>
<code> [14]          vs←vs CreateHTML_ForField thisStuff chapterNo</code>
<code> [15]      :Case 'Variable'</code>
<code> [16]          vs←vs CreateHTML_ForVars thisStuff chapterNo</code>
<code> [17]      :CaseList 'Method' 'Function'</code>
<code> [18]          vs←vs CreateHTML_ForMethodAndFunction thisStuff chapterNo</code>
<code> [19]      :Case 'Operator'</code>
<code> [20]          vs←vs CreateHTML_ForOperator thisStuff chapterNo</code>
<code> [21]      :Case 'Interface Method'                                                ⍝ implemented ones!</code>
<code class="emphasize">→[22]          vs←vs CreateHTML_ForInterFace data</code>
<code> [23]      :EndSelect</code>
<code> [24]  :EndFor</code>
</div>
<code class="header" id="listing_53">#.ADOC.ADOC.ADOC.HandleVersionInHeader &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←HandleVersionInHeader(ref header)</code>
<code> [1]      ⍝ Handle special case: is there a function `Version`, and does it return the right stuff?</code>
<code> [2]   r←header</code>
<code> [3]   :If ~ignoreVersion</code>
<code> [4]       txt←''</code>
<code> [5]       :If (⊂'Version')∊ref.⎕NL-3 ⍝ Is there a "Version" function?</code>
<code> [6]           :Trap 0 ⍝ not nice, but these calls may fail for all sorts of reasons.</code>
<code> [7]               :If 9.1≡⎕NC⊂⍕ref  ⍝ Is it an ordinary namespace?!</code>
<code> [8]                   body←ref.⎕NR'Version'</code>
<code> [9]                   txt←ref.{11::'' ⋄ ,⍎⍵}'Version'</code>
<code> [10]              :Else</code>
<code> [11]                  txt←ref.Version</code>
<code> [12]              :EndIf</code>
<code> [13]          :Else</code>
<code class="emphasize">→[14]              qdmx←⎕DMX</code>
<code class="emphasize">→[15]              ⎕←'Processing the "Version" function crashed (',qdmx.EM,')'</code>
<code> [16]          :EndTrap</code>
<code> [17]      :ElseIf (⊂'Version')∊ref.⎕NL-2 ⍝ Is there a "Version" variable?</code>
<code> [18]          txt←ref.Version</code>
<code> [19]      :EndIf</code>
<code> [20]      :If 0≠≢txt</code>
<code> [21]          :If 2&gt;|≡txt</code>
<code> [22]              txt←⊆{'+'∊⍵:⍵↑⍨¯1+⍵⍳'+' ⋄ ⍵}txt</code>
<code> [23]          :Else</code>
<code> [24]              txt←{'Version ',({'+'∊⍵:⍵↑⍨¯1+⍵⍳'+' ⋄ ⍵}⍺),' from ',⍵}/(3=≢txt)↓txt</code>
<code> [25]          :EndIf</code>
<code> [26]          txt←('' '' '## Version'),txt</code>
<code> [27]          :If 0=≢r</code>
<code> [28]              r←,⊂'Txt'txt</code>
<code> [29]          :Else</code>
<code> [30]              last←≢r</code>
<code> [31]              (last⊃r)←txt{⍵[1],(⊂(2⊃⍵),⍺)}last⊃r</code>
<code> [32]          :EndIf</code>
<code> [33]      :EndIf</code>
<code> [34]  :EndIf</code>
</div>
<code class="header" id="listing_54">#.ADOC.ADOC.ADOC.HandleHistoryInHeader &mdash; 91%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←HandleHistoryInHeader(ref header)</code>
<code> [1]      ⍝ Handle special case: is there a function `History`, and does it either return the right stuff</code>
<code> [2]      ⍝ or consist of comments useful for ADOC?</code>
<code> [3]   r←header</code>
<code> [4]   :If ~_ignoreHistory</code>
<code> [5]       txt←''</code>
<code> [6]       :If (⊂'History')∊ref.⎕NL-3 ⍝ Is there a "History" function?</code>
<code> [7]           txt←''</code>
<code> [8]           :If 0=↑↑ref.⎕AT'History'</code>
<code> [9]               :If 0≠≢txt←P.APLTreeUtils2.DLB 1↓ref.⎕NR'History'</code>
<code> [10]              :AndIf 0≠≢txt←1↓¨('⍝'=↑¨txt)/txt</code>
<code> [11]                  txt←(⌊/+/∧\' '=⊃txt)↓¨txt</code>
<code> [12]              :Else</code>
<code> [13]                  source←⎕SRC ref</code>
<code> [14]                  buffer←'^\s*''.+''' '^\s*⍝.*$' '^\s*∇\s*History\b'⎕R(,¨'&amp;' '&amp;' '∇∇')⍠('Greedy' 0)⊣source</code>
<code> [15]                  :If 0&lt;+/bool←∨/¨'∇∇'∘⍷¨buffer</code>
<code> [16]                      buffer←(bool⍳1)↓buffer</code>
<code> [17]                      buffer←P.APLTreeUtils2.DLB(↑'^\s*∇\s*$'⎕S 2⍠('Greedy' 0)⊣buffer)↑buffer</code>
<code> [18]                      :If 0=+/~(↑¨buffer)∊':⍝'</code>
<code> [19]                          txt←1↓¨('⍝'=↑¨buffer)/buffer</code>
<code> [20]                      :EndIf</code>
<code> [21]                  :EndIf</code>
<code> [22]              :EndIf</code>
<code> [23]          :Else</code>
<code> [24]              :Trap 0 ⍝ not nice, but these calls may very well fail</code>
<code> [25]                  :If 9.1≡⎕NC⊂⍕ref  ⍝ Is it an ordinary namespace?!</code>
<code> [26]                      body←ref.⎕NR'History'</code>
<code> [27]                      txt←ref.{11::'' ⋄ ⍎⍵}'History'</code>
<code> [28]                  :Else</code>
<code class="emphasize">→[29]                      txt←ref.History</code>
<code> [30]                  :EndIf</code>
<code> [31]              :EndTrap</code>
<code> [32]          :EndIf</code>
<code> [33]      :ElseIf (⊂'History')∊ref.⎕NL-2 ⍝ Is there a "History" variable...</code>
<code> [34]      :AndIf 0&lt;≢ref.History ⍝ ... that is not empty?</code>
<code> [35]          txt←ref.History</code>
<code> [36]      :EndIf</code>
<code> [37]      :If 0≠≢txt</code>
<code> [38]          :If 2=⍴⍴txt</code>
<code class="emphasize">→[39]              txt←{'&lt;pre&gt;',⍵,'&lt;/pre&gt;'}¨↓⎕FMT txt</code>
<code> [40]          :EndIf</code>
<code> [41]          txt←{2=≡⍵:⍵ ⋄ ↓⍵}txt</code>
<code> [42]          txt←('' '' '## History'),txt</code>
<code> [43]          :If 0=≢r</code>
<code class="emphasize">→[44]              r←,⊂'Txt'txt</code>
<code> [45]          :Else</code>
<code> [46]              last←≢r</code>
<code> [47]              (last⊃r)←txt{⍵[1],(⊂(2⊃⍵),⍺)}last⊃r</code>
<code> [48]          :EndIf</code>
<code> [49]      :EndIf</code>
<code> [50]  :EndIf</code>
</div>
<code class="header" id="listing_55">#.ADOC.ADOC.ADOC.Info &mdash; 92%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{verbose}Info scriptName</code>
<code> [1]         ⍝ Prints the most important facts about the given script to the session window.\\</code>
<code> [2]         ⍝ By default only the names of functions are reported. To get syntax information,</code>
<code> [3]         ⍝ pass either a 1 or `'full'` as left argument.\\</code>
<code> [4]         ⍝ Together with `Browse` this is the second major shared method.</code>
<code> [5]   :Access Public Shared</code>
<code> [6]   (∆EM←'Please pass references only!')⎕SIGNAL 11/⍨{⍵≡⍕¨⍵}scriptName</code>
<code> [7]   r←''</code>
<code> [8]   verbose←{2=⎕NC ⍵:⍎⍵ ⋄ 0}'verbose'</code>
<code> [9]   verbose←{IsChar ⍵:'full'≡⎕C ⍵ ⋄ (,1)≡,⍵}verbose</code>
<code> [10]  :If 9.5 9.4 9.1∊⍨(⍎1⊃⎕NSI){|⍺.⎕NC ⍵}⊂⍕scriptName</code>
<code> [11]      my←⎕NEW ⎕THIS          ⍝ We need to instantiate ADOC for this kind of thing</code>
<code> [12]      my.Analyze scriptName</code>
<code> [13]      data←5⊃1⊃my.Meta</code>
<code> [14]      r,←(⎕UCS 13),⍨'*** ',' ***',⍨⊃{0=≢3⊃⍵:{⍺,' (',⍵,')'}/⍵[1 2] ⋄ {⍺,' &lt; ',⍵}/⍵[1 3]}3↑1⊃my.Meta</code>
<code> [15]      :If (⊂1 2⊃my.Meta)∊'ScriptedNamespace' 'Namespace'</code>
<code> [16]          r,←verbose ListNamespace data</code>
<code> [17]      :Else</code>
<code> [18]          r,←verbose ListNonNamespaces data</code>
<code> [19]      :EndIf</code>
<code> [20]  :Else</code>
<code class="emphasize">→[21]      'Right argument must be a reference pointing to a class, namespace or interface'⎕SIGNAL 11</code>
<code> [22]  :EndIf</code>
</div>
<code class="header" id="listing_56">#.ADOC.ADOC.ADOC.ConvertOrdinaryNamespace2Scripted &mdash; 92%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {ref}←ConvertOrdinaryNamespace2Scripted ref</code>
<code> [1]   tmpFilename←P.FilesAndDirs.GetTempFilename2''</code>
<code> [2]   1 ⎕NDELETE tmpFilename</code>
<code> [3]   tmpFilename←↑,/2↑⎕NPARTS tmpFilename</code>
<code> [4]   'Create!'P.FilesAndDirs.CheckPath tmpFilename</code>
<code> [5]   :Trap 903</code>
<code> [6]       {}⎕SE.SALT.Save ref tmpFilename ⍝,' -convert'</code>
<code> [7]   :Else</code>
<code class="emphasize">→[8]       11 ⎕SIGNAL⍨'Unable to convert "',(⍕ref),'"'</code>
<code> [9]   :EndTrap</code>
<code> [10]  source←⎕SE.SALT.Load tmpFilename,' -source'</code>
<code> [11]  source←(~∨/¨'⍝ === End of variables definition ==='∘⍷¨source)/source  ⍝ Injected by SALT</code>
<code> [12]  source←(~∨/¨'⍝ === End of variable definition ==='∘⍷¨source)/source  ⍝ In case Dyalog fixes the typo one day</code>
<code> [13]  #.ADOC_Temp.⎕FIX source</code>
<code> [14]  ref←⍎'#.ADOC_Temp.',↑#.ADOC_Temp.⎕NL-9</code>
</div>
<code class="header" id="listing_57">#.ADOC.ADOC.ADOC.CreateHTML_ForProperty &mdash; 93%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateHTML_ForProperty(data chapterNo)</code>
<code> [1]   Body←''</code>
<code> [2]   firstProperty←vs.firstProperty</code>
<code> [3]   :If firstProperty</code>
<code> [4]       Body,←((MakeBookmark'Properties'),('h4 id="',GetChapterNo,':props"')tag'Properties')</code>
<code> [5]       Body,←PrepareSubLinks vs.publicStuff'Property'vs.formattedScriptName</code>
<code> [6]       firstProperty←0</code>
<code> [7]   :EndIf</code>
<code> [8]   Body,←vs.topRef,({(MakeBookmark ⍵),('h5 class="aplname" id="',GetChapterNo,':',(',_'∘Replace¨'name'GetSingle data),'"')tag ⍵}('name'GetSingle data))</code>
<code> [9]   Body,←'p class="small"'tag'(',('access'GetSingle data),({0=≢⍵:'' ⋄ ',',⊃{⍺,', ',⍵}/⍵}('keywords'GetSingle data),('readonly'GetSingle data)/⊂'readonly'),')'</code>
<code> [10]  :If 0≠≢'more'GetSingle data</code>
<code class="emphasize">→[11]      Body,←PolishMore'more'GetSingle data</code>
<code> [12]  :EndIf</code>
<code> [13]  :If 0≠≢'comments'GetSingle data</code>
<code> [14]      Body,←PolishComments('comments'GetSingle data)0 0 chapterNo</code>
<code> [15]  :EndIf</code>
<code> [16]  vs.Body,←Body</code>
<code> [17]  vs.firstProperty←firstProperty</code>
</div>
<code class="header" id="listing_58">#.ADOC.ADOC.ADOC.PolishComments &mdash; 93%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{convertHeader}PolishComments(markdown hasContainers isContainer chapterNo)</code>
<code> [1]      ⍝ Interprets the "leading" comments as extended Markdown.</code>
<code> [2]      ⍝ Via the (optional) left argument one can force any headers in `markdown` to be converted to &lt;h6&gt;.</code>
<code> [3]      ⍝ This makes sense in case it is a function/operator.</code>
<code> [4]   :If 0=≢∊markdown</code>
<code> [5]       r←''</code>
<code> [6]   :Else</code>
<code> [7]       convertHeader←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 0}'convertHeader'</code>
<code> [8]       :If convertHeader</code>
<code> [9]           markdown←'(^\s{0,3})#{1,5} '⎕R'\1###### '⊣markdown  ⍝ All headers are converted to level 6.</code>
<code> [10]      :EndIf</code>
<code> [11]      markdown←ReplaceDoubleBackslashByNewLine markdown</code>
<code> [12]      markdown←isContainer↓,markdown</code>
<code> [13]      :If 0≠≢markdown←(⌊/+/¨∧\¨markdown=' ')↓¨markdown</code>
<code> [14]          parms←P.MarkAPL.CreateParms</code>
<code> [15]          parms.verbose←0</code>
<code> [16]          parms.bookmarkLink←6</code>
<code> [17]          ns←P.MarkAPL.Init parms markdown</code>
<code> [18]          ns←P.MarkAPL.Process ns</code>
<code> [19]          r←'&lt;div class="header"&gt;',(⊃,/(⎕UCS 13),¨ns.html),'&lt;/div&gt;'</code>
<code> [20]      :Else</code>
<code class="emphasize">→[21]          r←'&lt;div class="header"&gt;&lt;/div&gt;'</code>
<code> [22]      :EndIf</code>
<code> [23]  :EndIf</code>
</div>
<code class="header" id="listing_59">#.ADOC.ADOC.ADOC.GetBase &mdash; 93%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetBase(headerLine scriptRef)</code>
<code> [1]        ⍝ Return full path to the base class (if any)</code>
<code> [2]   r←''</code>
<code> [3]   :If _Inherit</code>
<code> [4]       bool←~MaskText¨headerLine</code>
<code> [5]   :AndIf 0≠≢where←⍸∨/¨':Class '∘⍷¨bool\¨bool/¨headerLine</code>
<code> [6]       buffer←(1⊃where)⊃headerLine</code>
<code> [7]       buffer←(≢':Class ')↓P.APLTreeUtils2.DMB buffer</code>
<code> [8]       buffer←({~⍵∨≠\⍵}buffer='''')/buffer</code>
<code> [9]       buffer↑⍨←¯1+buffer⍳'⍝'</code>
<code> [10]  :AndIf 0≠≢buffer←(buffer⍳':')↓buffer</code>
<code> [11]      :If ','∊buffer</code>
<code class="emphasize">→[12]          r←P.APLTreeUtils2.DMB¨{⍵⊂⍨','≠⍵}buffer</code>
<code> [13]      :Else</code>
<code> [14]          r←⊂P.APLTreeUtils2.DMB buffer</code>
<code> [15]      :EndIf</code>
<code> [16]      parent←1⊃'.'P.APLTreeUtils2.SplitPath⍕scriptRef</code>
<code> [17]      r←parent∘{'#'=1⍴⍵:⍵ ⋄ ⍺,⍵}¨r</code>
<code> [18]  :EndIf</code>
</div>
<code class="header" id="listing_60">#.ADOC.ADOC.ADOC.CreateHTML_ForField &mdash; 94%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateHTML_ForField(data chapterNo)</code>
<code> [1]   Body←''</code>
<code> [2]   firstField←vs.firstField</code>
<code> [3]   :If firstField</code>
<code> [4]       Body,←((MakeBookmark'Fields'),('h4 id="',GetChapterNo,':fields"')tag'Fields')</code>
<code> [5]       Body,←PrepareSubLinks vs.publicStuff'Field'vs.formattedScriptName</code>
<code> [6]       firstField←0</code>
<code> [7]   :EndIf</code>
<code> [8]   Body,←vs.topRef,{(MakeBookmark ⍵),('h5 class="aplname" id="',GetChapterNo,':',({⍵↑⍨¯1+⍵⍳'←'}'name'GetSingle data),'"')tag ⍵}{⍵↑⍨¯1+⍵⍳'←'}'name'GetSingle data</code>
<code> [9]   Body,←'p class="small"'tag(('access'GetSingle data),(('readonly'GetSingle data)/', readonly'))</code>
<code> [10]  :If 0≠≢'more'GetSingle data</code>
<code class="emphasize">→[11]      Body,←PolishMore'more'GetSingle data</code>
<code> [12]  :EndIf</code>
<code> [13]  :If 0≠≢'comments'GetSingle data</code>
<code> [14]      Body,←PolishComments('comments'GetSingle data)0 0 chapterNo</code>
<code> [15]  :EndIf</code>
<code> [16]  :If 0≠≢'syntax'GetSingle data</code>
<code> [17]      Body,←'p class="aplcode"'tag'Initialised with: ',MarkupInlineAPL_Code{'`',⍵,'`'}P.APLTreeUtils2.DMB'syntax'GetSingle data</code>
<code> [18]  :EndIf</code>
<code> [19]  vs.Body,←Body</code>
<code> [20]  vs.firstField←firstField</code>
</div>
<code class="header" id="listing_61">#.ADOC.ADOC.ADOC.HandleCopyRightInHeader &mdash; 94%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←HandleCopyRightInHeader(ref header)</code>
<code> [1]      ⍝ Handle special case: is there a function `Copyright`, and does it return the right stuff?</code>
<code> [2]   r←header</code>
<code> [3]   :If ~_ignoreCopyright</code>
<code> [4]       txt←''</code>
<code> [5]       :If (⊂'Copyright')∊ref.⎕NL-3 ⍝ Is there a "Copyright" function?</code>
<code> [6]           txt←''</code>
<code> [7]           :If 9.1≡⎕NC⊂⍕ref  ⍝ Is it an ordinary namespace?!</code>
<code> [8]               body←ref.⎕NR'Copyright'</code>
<code> [9]               txt←ref.{11::'' ⋄ ,⍎⍵}'Copyright'</code>
<code> [10]          :Else</code>
<code> [11]              txt←{0 1∊⍨≡⍵:,⊂⍵ ⋄ 2=⍴⍴⍵:↓⍵ ⋄ ⍵},ref.Copyright</code>
<code> [12]          :EndIf</code>
<code> [13]      :ElseIf (⊂'Copyright')∊ref.⎕NL-2 ⍝ Is there a "Copyright" variable?</code>
<code> [14]          txt←ref.Copyright</code>
<code> [15]      :EndIf</code>
<code> [16]      :If 0≠≢txt</code>
<code> [17]          txt←('' '' '## Copyright'),,/txt</code>
<code> [18]          :If 0=≢r</code>
<code class="emphasize">→[19]              r←,⊂'Txt'txt</code>
<code> [20]          :Else</code>
<code> [21]              ((≢r)⊃r)←txt{⍵[1],(⊂(2⊃⍵),⍺)}(≢r)⊃r</code>
<code> [22]          :EndIf</code>
<code> [23]      :EndIf</code>
<code> [24]  :EndIf</code>
</div>
<code class="header" id="listing_62">#.ADOC.ADOC.ADOC.AnalyzeProperty &mdash; 95%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←AnalyzeProperty(noOf source masked)</code>
<code> [1]   r←⍬</code>
<code> [2]   :If ∨/bool←∨/¨':access public'∘⍷¨P.APLTreeUtils2.DMB¨masked</code>
<code> [3]       result←⊂'type' 'Property'</code>
<code> [4]       (buffer remarks)←SplitAtLamp source</code>
<code> [5]       (name keywords)←{((≢⍵)⊃⍵)(¯1↓⍵)}' 'P.APLTreeUtils2.Split P.APLTreeUtils2.DMB buffer</code>
<code> [6]   :AndIf IgnorePattern{0=≢⍺:1 ⋄ ⍺∨.≠(≢⍺)↑⍵}name</code>
<code> [7]       :If _ignoreCopyright∨name≢'Copyright'</code>
<code> [8]       :AndIf _ignoreVersion∨name≢'Version'</code>
<code> [9]       :AndIf _ignoreHistory∨name≢'History'</code>
<code> [10]          keywords↓⍨←':'=↑↑keywords</code>
<code> [11]          result,←⊂'name'name</code>
<code> [12]          result,←⊂'access'(↑('Instance' 'Shared')[1+∨/∨/⊃'shared'∘⍷¨{(⊂⍵)⊃¨⍨{⍵/⍳≢⍵}∨/¨':access'∘⍷¨⍵},¨masked])</code>
<code> [13]          result,←⊂'readonly'(~∨/'∇set'⍷∊source~¨' ')</code>
<code> [14]          :If 0=≢remarks</code>
<code class="emphasize">→[15]              result,←⊂'comments'((+/∧\'⍝'={↑¨⍵~¨' '}1↓source)↑1↓source)</code>
<code> [16]          :Else</code>
<code> [17]              result,←⊂'comments'({0 1∊⍨≡⍵:⊂⍵ ⋄ ⍵}remarks)</code>
<code> [18]          :EndIf</code>
<code> [19]          result,←⊂'keywords'keywords</code>
<code> [20]          result,←⊂'more' ''</code>
<code> [21]          r←⊃result</code>
<code> [22]      :EndIf</code>
<code> [23]  :EndIf</code>
</div>
<code class="header" id="listing_63">#.ADOC.ADOC.ADOC.PrepareSubLinks &mdash; 96%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←{methodType}PrepareSubLinks(data type scriptName)</code>
<code> [1]        ⍝ Prepare a link list for a given type.</code>
<code> [2]        ⍝ Make it a numbered list if there are more than 4 items.</code>
<code> [3]   r←⍬</code>
<code> [4]   :If 0=⎕NC'OutputType' ⍝ is it an instance?</code>
<code> [5]   :OrIf OutputType≡'Web'</code>
<code> [6]       :If (⊂type)∊'Field' 'Function' 'Operator' 'Variable'</code>
<code> [7]           noOf←+/bool←type∘≡¨Get data</code>
<code> [8]       :ElseIf 'Property'≡type</code>
<code> [9]           bool←type∘≡¨Get data</code>
<code> [10]          noOf←≢↑,/{','∊⍵:','P.APLTreeUtils2.Split ⍵ ⋄ ⊂⍵}¨'name'Get bool/data</code>
<code> [11]      :ElseIf 'Interface Method'≡type</code>
<code class="emphasize">→[12]          noOf←+/bool←('Interface Method'∘≡¨Get data)</code>
<code> [13]      :ElseIf 'Operators'≡type</code>
<code> [14]          noOf←+/bool←('Operator'∘≡¨Get data)</code>
<code> [15]      :Else</code>
<code> [16]          noOf←+/bool←((Get data)∊'Method' 'Function')∧methodType∘≡¨'access'Get data</code>
<code> [17]      :EndIf</code>
<code> [18]      :If 0&lt;+/bool</code>
<code> [19]          :If 0≠≢list←'name'Get bool/data</code>
<code> [20]          :AndIf 0≠≢list←(0&lt;≢¨list)/list</code>
<code> [21]              list2←,↑,/{','∊⍵:','P.APLTreeUtils2.Split ⍵ ⋄ ⊂⍵}¨list</code>
<code> [22]              list2←{⍵↑⍨¯1+⍵⍳'←'}¨list2</code>
<code> [23]              list2←list2[SortAlphabet⍋⊃list2]</code>
<code> [24]              list←list[SortAlphabet⍋⊃list]</code>
<code> [25]              :If 1&lt;≢list2</code>
<code> [26]                  :If 4≥≢list2</code>
<code> [27]                      links←nl,⍨⊃,/{⍺,' | ',⍵}/{('a href="#',(GetChapterNo,':',⍵),'"')tag ⍵}¨list2</code>
<code> [28]                      r←'div class="sublinks"'tag links</code>
<code> [29]                  :Else</code>
<code> [30]                      buff←↑,/{(1+','+.=⍵)⍴⊂⍵}¨list</code>
<code> [31]                      buff←',_'∘Replace¨buff</code>
<code> [32]                      links←'ol class="sublinks"'tag⊃,/'li'∘tag¨list2{('a href="#',(GetChapterNo,':',⍵),'"')tag ⍺}¨buff</code>
<code> [33]                      r←'div class="sublinks"'tag links</code>
<code> [34]                  :EndIf</code>
<code> [35]              :EndIf</code>
<code> [36]          :EndIf</code>
<code> [37]      :EndIf</code>
<code> [38]  :EndIf</code>
</div>
<code class="header" id="listing_64">#.ADOC.ADOC.ADOC.AnalyzeFns &mdash; 97%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←vs AnalyzeFns(scriptRef noOf)</code>
<code> [1]   r←⍬</code>
<code> [2]   more←''</code>
<code> [3]   buffer←P.APLTreeUtils2.DMB⊃noOf↑vs.maskedSource</code>
<code> [4]   keywords←''</code>
<code> [5]   name←1↓GetNameFromHeader 1⊃vs.origSource</code>
<code> [6]   :If vs.isNamespace</code>
<code> [7]   :AndIf ~(⊂name)∊vs.public</code>
<code> [8]       :Return</code>
<code> [9]   :EndIf</code>
<code> [10]  syntax←GetSyntax 1⊃vs.origSource</code>
<code> [11]  (masked source)←noOf↑¨vs.(maskedSource origSource)</code>
<code> [12]  :If 0&lt;+/bool←∨/¨∨/¨':implements constructor' ':implements destructor' ':implements method '⍷¨⊂buffer</code>
<code> [13]      :Select ↑bool⍳1</code>
<code> [14]      :Case 1</code>
<code> [15]          type←'Constructor'</code>
<code> [16]          access←'Public'</code>
<code> [17]      :Case 2</code>
<code> [18]          type←'Destructor'</code>
<code> [19]          access←'Private'</code>
<code> [20]      :Case 3 ⍝ interface method</code>
<code> [21]          type←'Interface Method'</code>
<code> [22]          access←'Public'</code>
<code> [23]          more,←⊂1↓↑(∨/':implements '⍷⊃masked)/source</code>
<code> [24]      :EndSelect</code>
<code> [25]  :Else</code>
<code> [26]      :If vs.isNamespace</code>
<code> [27]          access←'Shared'</code>
<code> [28]          type←(1+3.1=scriptRef.⎕NC⊂name)⊃'Operator' 'Function'</code>
<code> [29]          :If 0≠≢vs.public</code>
<code> [30]          :AndIf ~(⊂name)∊vs.public</code>
<code class="emphasize">→[31]              :Return</code>
<code> [32]          :EndIf</code>
<code> [33]          buffer←''</code>
<code> [34]      :ElseIf ∨/∨/':access'⍷buffer</code>
<code> [35]          type←'Method'</code>
<code> [36]          buffer⌷[1]⍨←1⍳⍨∨/':access '⍷buffer</code>
<code> [37]          :If ∨/'shared'⍷buffer</code>
<code> [38]              access←'Shared'</code>
<code> [39]          :Else ⍝ Therefore, it MUST be "instanced"</code>
<code> [40]              access←'Instance'</code>
<code> [41]                ⍝ Only "instance" methods may be overridable:</code>
<code> [42]              :If ∨/' overridable'⍷buffer</code>
<code> [43]                  more,←⊂'Overridable'</code>
<code> [44]              :EndIf</code>
<code> [45]          :EndIf</code>
<code> [46]                ⍝ Only "instance" methods may override:</code>
<code> [47]          :If ∨/' override'⍷buffer</code>
<code> [48]              more,←⊂'Override'</code>
<code> [49]          :EndIf</code>
<code> [50]      :ElseIf vs.isInterface</code>
<code> [51]          type←'Method'</code>
<code> [52]          access←'Instance'  ⍝ Interface methods are always "Public" and therefore either "Instance" or "Shared"!</code>
<code> [53]          buffer←''</code>
<code> [54]      :Else</code>
<code> [55]          :Return</code>
<code> [56]      :EndIf</code>
<code> [57]      keywords←({(1 ⎕C 1↑⍵),⎕C 1↓⍵}¨{' 'P.APLTreeUtils2.Split ⍵↓⍨⍵⍳' '}buffer)~'Public' 'Instance' 'Shared'</code>
<code> [58]      :If (⊂'private')∊⎕C keywords</code>
<code> [59]          :Return</code>
<code> [60]      :EndIf</code>
<code> [61]  :EndIf</code>
<code> [62]  remarks←''</code>
<code> [63]  noOf←≢source←RemoveMultiLocalLines source</code>
<code> [64]  :If 0≠≢{⍵/⍨'⍝'=↑¨⍵}buffer←1↓noOf↑source ⍝ remarks</code>
<code> [65]      buffer/⍨←{~∨/∨/¨':access' ':implements'{⍺≡⎕C(≢⍺)↑⍵}¨⊂⍵}∘P.APLTreeUtils2.DLB¨buffer</code>
<code> [66]      buffer↓¨⍨←{+/∧\' '=⍵}¨buffer</code>
<code> [67]      buffer↑⍨←+/∧\'⍝'=↑¨buffer</code>
<code> [68]      buffer⌿⍨←'⍝⍝'∘≢¨2↑¨buffer</code>
<code> [69]  :AndIf 0≠≢buffer←1↓¨buffer</code>
<code> [70]      buffer←(' '=↑¨buffer)↓¨buffer</code>
<code> [71]      remarks←{⍵,' '/⍨' '≠↑¯1↑⍵}¨buffer</code>
<code> [72]  :EndIf</code>
<code> [73]  :If IgnorePattern{0=≢⍺:1 ⋄ ⍺∨.≠(≢⍺)↑⍵}name</code>
<code> [74]            ⍝ A method name may appear again: an included namespace may provide a</code>
<code> [75]            ⍝ method with a name also used in the container class. Therefore, any</code>
<code> [76]            ⍝ additional occurance must be ignored!</code>
<code> [77]      :If 0=≢vs.publishedStuff</code>
<code class="emphasize">→[78]      :OrIf ~(⊂name)∊(⊂'')~⍨{'Method'≢2⊃⍵[⍵[1;]⍳⊂'type';]:'' ⋄ 2⊃⍵[⍵[;1]⍳⊂'name';]}¨vs.publishedStuff</code>
<code> [79]          r←⊃('type'type)('name'name)('access'access)('syntax'syntax)('keywords'keywords)('more'more)('comments'remarks)</code>
<code> [80]      :EndIf</code>
<code> [81]  :EndIf</code>
</div>
<code class="header" id="listing_65">#.ADOC.ADOC.ADOC.Analyze_ &mdash; 97%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{embeddedClassNames}Analyze_ scriptRef</code>
<code> [1]        ⍝ Analyzes a particular script and appends the result to the _META array.</code>
<code> [2]        ⍝ If the left argument is specified, only that (or these) embedded class(es) gets analyzed.</code>
<code> [3]        ⍝ Returns either an empty vector or a vector of character vectors with the name(s) of any embedded classes.</code>
<code> [4]   A←P.APLTreeUtils2</code>
<code> [5]   r←⍬</code>
<code> [6]   vs←⎕NS''</code>
<code> [7]   vs.publishedStuff←vs.inheritsFrom←''</code>
<code> [8]   vs.devisorMeta←⍬</code>
<code> [9]   vs.formattedScriptName←{⍵↑⍨1+-'.'⍳⍨⌽⍵}{⍵↓⍨2×'#.'≡2↑⍵}⍕scriptRef</code>
<code> [10]  :Trap 16</code>
<code> [11]      vs.origSource←{⍵↓⍨+/∧/' '=⍵}¨⎕SRC scriptRef</code>
<code> [12]  :Else</code>
<code> [13]      :If 9.1=⎕NC⊂⍕scriptRef</code>
<code> [14]          #.⎕SHADOW¨'ADOC_Temp' 'ADOC_Source'</code>
<code> [15]          'ADOC_Temp'#.⎕NS''</code>
<code> [16]          '#.ADOC_Source'scriptRef.⎕NS↓scriptRef.⎕NL 2 3 4</code>
<code> [17]          #.ADOC_Source.⎕EX #.ADOC_Source.⎕NL 3.6 3.9 7.9   ⍝ Delete external stuff, otherwise SALT will crash (Bug &lt;01706&gt;)</code>
<code> [18]          scriptRef←ConvertOrdinaryNamespace2Scripted #.ADOC_Source</code>
<code> [19]          vs.origSource←{⍵↓⍨+/∧/' '=⍵}¨⎕SRC scriptRef</code>
<code> [20]          vs.origSource/⍨←1,~∧\'⍝'=↑¨1↓vs.origSource    ⍝ Get rid of any leading comments as they are not meaningful in this context</code>
<code> [21]      :Else</code>
<code class="emphasize">→[22]          (∆EM←'Invalid right argument')⎕SIGNAL 11</code>
<code> [23]      :EndIf</code>
<code> [24]  :EndTrap</code>
<code> [25]  vs.require←''</code>
<code> [26]  embeddedClassNames←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ''}'embeddedClassNames'</code>
<code> [27]  :If 0≠≢embeddedClassNames</code>
<code> [28]       ⍝ User asks for a class embedded in another one. So we simply replace "origSource" by the source of the embedded class</code>
<code> [29]      :If 0=≢buffer←1↓vs.origSource[⍸':class'∘{⍺≡⎕C(≢⍺)↑⍵}¨A.DMB¨vs.origSource] ⍝ 1↓ for itself</code>
<code class="emphasize">→[30]          :Return</code>
<code> [31]      :EndIf</code>
<code> [32]      bool←vs.origSource∊buffer</code>
<code> [33]      bool∨←vs.origSource∊¯1↓vs.origSource[⍸':endclass'∘{⍺≡⎕C(≢⍺)↑⍵}¨A.DMB¨vs.origSource] ⍝ ¯1↓ for itself</code>
<code> [34]      buffer←({⍵∨≠\⍵}bool)/vs.origSource</code>
<code> [35]      buffer{(⊂¨⍵/⍺),¨⍺⊂⍨~⍵}←':class'Search A.DMB¨buffer</code>
<code> [36]      vs.origSource←buffer⊃⍨1⍳⍨embeddedClassNames∘≡¨{{⍵↑⍨¯1+⌊/⍵⍳' :'}(≢':class ')↓A.DMB ⍵}¨1⊃¨buffer</code>
<code> [37]      vs.formattedScriptName←embeddedClassNames</code>
<code> [38]  :ElseIf 0≠≢vs.inheritsFrom←GetBase vs.origSource scriptRef</code>
<code> [39]      (∆EM←'Unknown devisor: ',⍕vs.inheritsFrom)⎕SIGNAL 11/⍨9∨.≠⎕NC⊃vs.inheritsFrom</code>
<code> [40]      Analyze_∘⍎¨vs.inheritsFrom</code>
<code> [41]      vs.devisorMeta←_META[(⍴vs.inheritsFrom){1+⍵-⌽⍳⍺}⍴_META]</code>
<code> [42]      _META←(-≢vs.devisorMeta)↓_META</code>
<code> [43]  :EndIf</code>
<code> [44]  :If 0&lt;+/bool←':include'∘≡¨⎕C(≢':include')↑¨A.DLB¨vs.origSource</code>
<code> [45]      vs.namespaceList←∪A.DLB¨{(≢':include ')↓⍵}¨A.DLB¨vs.origSource[⍸bool]</code>
<code> [46]      vs.namespaceList←{⍵↑⍨¯1+⍵⍳' '}¨vs.namespaceList</code>
<code> [47]      buffer←scriptRef MakeScriptFromNamespace¨vs.namespaceList</code>
<code> [48]      buffer←(~¨':namespace'∘Search¨buffer)/¨buffer</code>
<code> [49]      buffer←(~¨':endnamespace'∘Search¨buffer)/¨buffer</code>
<code> [50]      vs.origSource,←,¨⊃,/buffer</code>
<code> [51]  :EndIf</code>
<code> [52]  (vs.origSource vs.leadingDoc)←{noOf←+/∧\'⍝'=↑¨⍵ ⋄ (noOf↓⍵)(noOf↑⍵)}vs.origSource</code>
<code> [53]  vs.origSource/⍨←{~(⌽∧\⌽⍵)∨∧\⍵}0=≢¨vs.origSource</code>
<code> [54]  :If 0=≢embeddedClassNames</code>
<code> [55]      r←':class '{' '~¨⍨(≢⍺)↓¨A.DMB ⍵/⍨⍺{⍵≡¨⊂⍺}⎕C(≢⍺)↑¨A.DMB ⍵}1↓vs.origSource</code>
<code> [56]  :EndIf</code>
<code> [57]  vs.isInterface←∨/':interface '⍷⎕C vs.headerLine←1⊃vs.origSource</code>
<code> [58]  vs.devisor←{0=≢⍵:⍵ ⋄ ⊃{⍺,', ',⍵}/⍵}vs.inheritsFrom</code>
<code> [59]  vs.scriptType←'Interface' 'Namespace' 'Class'⊃⍨5 1 4⍳10×2⊃0 1⊤|#.⎕NC⊂⍕scriptRef</code>
<code> [60]  :If 0≠≢embeddedClassNames</code>
<code> [61]      vs.scriptType,←' embedded into ',⍕scriptRef</code>
<code> [62]  :EndIf</code>
<code> [63]  vs.public←''</code>
<code> [64]  :If vs.isNamespace←':NAMESPACE '{⍺≡(≢⍺)↑⍵}1 ⎕C A.DLB 1⊃vs.origSource</code>
<code> [65]      vs←GetPublicDefinitionFrom_NS scriptRef vs</code>
<code> [66]      :If 2=scriptRef.⎕NC'ADOC_Doc'</code>
<code> [67]          vs.origSource←vs.origSource[1],('⍝ '∘,¨scriptRef⍎'ADOC_Doc'),1↓vs.origSource</code>
<code> [68]          vs.origSource←('ADOC_Doc←'{⍺∘≢¨(≢⍺)⍴¨⍵}vs.origSource)/vs.origSource</code>
<code> [69]      :EndIf</code>
<code> [70]  :EndIf</code>
<code> [71]  vs.origSource←1↓¯1↓vs.origSource</code>
<code> [72]  (vs.origSource vs.headerDoc)←SplitIntoSourceAndLeadingComments vs.origSource</code>
<code> [73]  vs.headerDoc←vs.leadingDoc,vs.headerDoc</code>
<code> [74]  vs.headerDoc←{0=≢∊⍵:∊⍵ ⋄ ⍵}vs.headerDoc</code>
<code> [75]  vs.headerDoc←AnalyzeHeader(scriptRef vs.headerDoc)</code>
<code> [76]  vs.headerDoc←LookOutForSpecialFunctions(scriptRef vs.headerDoc)</code>
<code> [77]  vs.origSource←A.DLB A.DTB vs.origSource</code>
<code> [78]  vs.maskedSource←(MaskText¨vs.origSource){w←⍵ ⋄ (⍺/w)←' ' ⋄ w}¨vs.origSource</code>
<code> [79]  vs.commentsStartAt←¯1+vs.origSource⍳¨'⍝'</code>
<code> [80]  :If 0=≢vs.maskedSource←,¨⎕C vs.commentsStartAt↑¨vs.maskedSource</code>
<code> [81]      vs.publishedStuff,←ListVariables scriptRef vs.public</code>
<code> [82]      vs.publishedStuff←AnalyzeResult vs.publishedStuff</code>
<code> [83]      _META,←⊂vs.formattedScriptName vs.scriptType vs.devisor vs.headerDoc vs.publishedStuff vs.require</code>
<code> [84]  :Else</code>
<code> [85]      vs←LoopOverSource(scriptRef vs)</code>
<code> [86]      vs←vs ListDfnsAndDops scriptRef</code>
<code> [87]      vs.publishedStuff,←ListVariables scriptRef vs.public</code>
<code> [88]      vs.publishedStuff←AnalyzeResult vs.publishedStuff</code>
<code> [89]      _META,←⊂vs.formattedScriptName vs.scriptType vs.devisor vs.headerDoc vs.publishedStuff vs.require</code>
<code> [90]  :EndIf</code>
<code> [91]  :If 0≠≢vs.devisorMeta</code>
<code> [92]      MergeWithDevisor¨vs.devisorMeta</code>
<code> [93]  :EndIf</code>
</div>
<code class="header" id="listing_66">#.ADOC.ADOC.ADOC.set_Title &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_Title arg</code>
<code> [1]  (∆EM←'"Title" must be a string')⎕SIGNAL 11/⍨~IsChar arg.NewValue</code>
<code> [2]  (∆EM←'"Title" must be simple')⎕SIGNAL 11/⍨~0 1∊⍨≡arg.NewValue</code>
<code> [3]  _Title←arg.NewValue</code>
</div>
<code class="header" id="listing_67">#.ADOC.ADOC.ADOC.get_Title &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_Title</code>
<code> [1]  r←_Title</code>
</div>
<code class="header" id="listing_68">#.ADOC.ADOC.ADOC.set_IncludeReference &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_IncludeReference arg</code>
<code> [1]  (∆EM←'"IncludeReference" must be a Boolean')⎕SIGNAL 11/⍨~0 1∊⍨arg.NewValue</code>
<code> [2]  _IncludeReference←arg.NewValue</code>
</div>
<code class="header" id="listing_69">#.ADOC.ADOC.ADOC.set_Toc &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_Toc arg</code>
<code> [1]  (∆EM←'"Toc" must be a Boolean')⎕SIGNAL 11/⍨~0 1∊⍨arg.NewValue</code>
<code> [2]  _Toc←arg.NewValue</code>
</div>
<code class="header" id="listing_70">#.ADOC.ADOC.ADOC.set_Inherit &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_Inherit arg</code>
<code> [1]  (∆EM←'"Inherit" must be a Boolean')⎕SIGNAL 11/⍨~0 1∊⍨arg.NewValue</code>
<code> [2]  _Inherit←arg.NewValue</code>
</div>
<code class="header" id="listing_71">#.ADOC.ADOC.ADOC.get_IgnorePattern &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_IgnorePattern</code>
<code> [1]  r←_IgnorePattern</code>
</div>
<code class="header" id="listing_72">#.ADOC.ADOC.ADOC.set_ BrowserPath &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_73">#.ADOC.ADOC.ADOC.get_ BrowserPath &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_74">#.ADOC.ADOC.ADOC.set_ htmlFinalised &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_75">#.ADOC.ADOC.ADOC.get_ htmlFinalised &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_76">#.ADOC.ADOC.ADOC.get_Creator &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_Creator</code>
<code> [1]  r←_Creator</code>
</div>
<code class="header" id="listing_77">#.ADOC.ADOC.ADOC.set_Meta &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_78">#.ADOC.ADOC.ADOC.get_Meta &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_Meta</code>
<code> [1]  r←_META</code>
</div>
<code class="header" id="listing_79">#.ADOC.ADOC.ADOC.get_OutputType &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_OutputType</code>
<code> [1]  r←_OutputType</code>
</div>
<code class="header" id="listing_80">#.ADOC.ADOC.ADOC.set_SubTitles &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_81">#.ADOC.ADOC.ADOC.get_ignoreCopyright &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_ignoreCopyright</code>
<code> [1]  :If 2=⎕NC'_ignoreCopyright'</code>
<code> [2]      r←_ignoreCopyright</code>
<code> [3]  :Else</code>
<code> [4]      r←0</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_82">#.ADOC.ADOC.ADOC.get_ignoreHistory &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_ignoreHistory</code>
<code> [1]  :If 2=⎕NC'_ignoreHistory'</code>
<code> [2]      r←_ignoreHistory</code>
<code> [3]  :Else</code>
<code> [4]      r←0</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_83">#.ADOC.ADOC.ADOC.get_ignoreVersion &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_ignoreVersion</code>
<code> [1]  :If 2=⎕NC'_ignoreVersion'</code>
<code> [2]      r←_ignoreVersion</code>
<code> [3]  :Else</code>
<code> [4]      r←0</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_84">#.ADOC.ADOC.ADOC.set_view &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> set_view arg</code>
<code> [1]  (∆EM←'"view" must be a Boolean')⎕SIGNAL 11/⍨~arg.NewValue∊0 1</code>
<code> [2]  _view←arg.NewValue</code>
</div>
<code class="header" id="listing_85">#.ADOC.ADOC.ADOC.get_view &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←get_view</code>
<code> [1]  r←_view</code>
</div>
<code class="header" id="listing_86">#.ADOC.ADOC.ADOC.Version &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←Version</code>
<code> [1]  :Access Public shared</code>
<code> [2]  r←'ADOC' '7.1.0+90' '2023-06-11'</code>
</div>
<code class="header" id="listing_87">#.ADOC.ADOC.ADOC.History &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  History</code>
<code> [1]   :Access Public Shared</code>
<code> [2]        ⍝ * 7.1.0</code>
<code> [3]        ⍝   `]ADOC` will now process references pointing to a loaded Tatin package in a smart way</code>
<code> [4]        ⍝ * 7.0.1</code>
<code> [5]        ⍝   * Bug fix: under certain circumstances `Copyright` and/or `Version` and/or `History` did</code>
<code> [6]        ⍝     not get a caption assigned</code>
<code> [7]        ⍝ * 7.0.0</code>
<code> [8]        ⍝   * Breaking change: requires 18.0 or better</code>
<code> [9]        ⍝   * Breaking change: ADOC is now a Tatin package, and depends on Tatin packages</code>
<code> [10]       ⍝   * Breaking change: "IncludeCss" removed from the default parameter space (CreateBrowseDefaults)</code>
<code> [11]       ⍝   * Called without an argument ]ADoc now investigates the namespace it was called from</code>
<code> [12]       ⍝   * New parameter `htmlFilename` added to the parameter space.</code>
<code> [13]       ⍝   * `ADOC_Doc` may not be a function anymore: it **must** be a variable (vector of char vectors)</code>
<code> [14]       ⍝   * Needs `APLTreeUtils2` but does not :Include `APLTreeUtils` anymore</code>
<code> [15]       ⍝   * The reserved names `History`, `Version` and `Copyrigth` may (still) be functions, but they</code>
<code> [16]       ⍝     can now also be variables</code>
<code> [17]       ⍝   * The deprecated function `List` was removed</code>
<code> [18]       ⍝   * Bug fixes</code>
<code> [19]       ⍝     * In case ADOC_Doc did not carry any header...</code>
<code> [20]       ⍝       * no TOC was injected into the HTML</code>
<code> [21]       ⍝       * any `Version` function was ignored</code>
<code> [22]       ⍝     * Sort sequence was wrong (`Hello` should be listed *before* `Hello1`)</code>
<code> [23]       ⍝\\</code>
<code> [24]       ⍝ For information regarding older versions see &lt;https://github.com/aplteam/ADOC/releases&gt;</code>
</div>
<code class="header" id="listing_88">#.ADOC.ADOC.ADOC.make_1 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> make_1(fullDocName)</code>
<code> [1]  :Implements Constructor</code>
<code> [2]  :Access Public instance</code>
<code> [3]  make_0</code>
<code> [4]  _FULL_DOC_NAME←fullDocName</code>
</div>
<code class="header" id="listing_89">#.ADOC.ADOC.ADOC.make_0 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> make_0</code>
<code> [1]  :Implements Constructor</code>
<code> [2]  :Access Public instance</code>
<code> [3]  Init_HTML</code>
</div>
<code class="header" id="listing_90">#.ADOC.ADOC.ADOC.Init_HTML &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  Init_HTML</code>
<code> [1]   _HTML←⍬</code>
<code> [2]   _FULL_DOC_NAME←''</code>
<code> [3]   _DOCS←⍬</code>
<code> [4]   _META←⍬</code>
<code> [5]   _htmlFinalised←0</code>
<code> [6]   _WithRunningNumbers←¯1</code>
<code> [7]   _Creator←⎕AN</code>
<code> [8]   _BrowserPath←''</code>
<code> [9]   _OutputType←'Web'</code>
<code> [10]  _IncludeCss←1</code>
<code> [11]  _CssPath←''</code>
<code> [12]  _SubTitles←''</code>
<code> [13]  _ignoreCopyright←0</code>
<code> [14]  _ignoreVersion←0</code>
<code> [15]  _ignoreHistory←0</code>
<code> [16]  _embeddedClassesFlag←0</code>
<code> [17]  _view←1</code>
<code> [18]       ⍝</code>
<code> [19]  _embeddedClassNames←'' ⍝ Not a parameter but must be reset anyway</code>
<code> [20]  ⎕DF⍕⎕THIS</code>
</div>
<code class="header" id="listing_91">#.ADOC.ADOC.ADOC.RestoreDefaults &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  RestoreDefaults</code>
<code> [1]   :Access Public Shared</code>
<code> [2]      ⍝ Restore default values for all fields and properties.</code>
<code> [3]   _BrowserPath←''</code>
<code> [4]   _Inherit←1</code>
<code> [5]   _IgnorePattern←''</code>
<code> [6]   _IncludeReference←1</code>
<code> [7]   _Toc←1</code>
<code> [8]   _SubTitles←''</code>
<code> [9]   CssScreen←'screen'</code>
<code> [10]  CssPrint←'Print'</code>
<code> [11]  InLineCodePadding←5</code>
<code> [12]  InLineCodeColor←'#961c1c'</code>
<code> [13]  view←1</code>
</div>
<code class="header" id="listing_92">#.ADOC.ADOC.ADOC.CreateDocFooter &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  CreateDocFooter dummy</code>
<code> [1]      ⍝ Creates the footer of the document. Default for "Creator"</code>
<code> [2]      ⍝ is the current user (`⎕AN`).</code>
<code> [3]   :Access Public Instance</code>
<code> [4]   html←'&lt;br /&gt;&lt;br /&gt;'</code>
<code> [5]   html,←'&lt;div id="footer"&gt;',nl</code>
<code> [6]   html,←'span id="createdate"'tag'Created ',P.APLTreeUtils2.FormatDateTime ⎕TS</code>
<code> [7]   :If 0≠≢{2=⎕NC ⍵:⍎⍵ ⋄ ⎕AN}'Creator'</code>
<code> [8]       html,←'span id="createdby"'tag' by ',_Creator,' with ',{({⍵↑⍨1+-'.'⍳⍨⌽⍵}1⊃Version),' ',(2⊃⍵),' from ',3⊃⍵}3↑Version</code>
<code> [9]   :EndIf</code>
<code> [10]  html,←'&lt;/div&gt;',nl</code>
<code> [11]  _HTML,←html</code>
</div>
<code class="header" id="listing_93">#.ADOC.ADOC.ADOC.ListNamespace &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←verbose ListNamespace data</code>
<code> [1]   r←''</code>
<code> [2]   nl←,⎕UCS 13</code>
<code> [3]   :If 0≠≢buffer←data/⍨(Get data)∊'Function' 'Operator'</code>
<code> [4]       :If 0&lt;+/bool←'Function'∘≡¨'type'Get buffer</code>
<code> [5]           r,←nl,'Functions:'</code>
<code> [6]           r,←⊃,/nl,¨'  '∘,¨((1+verbose)⊃'name' 'syntax')Get bool/buffer</code>
<code> [7]       :EndIf</code>
<code> [8]       :If 0&lt;+/bool←'Operator'∘≡¨'type'Get buffer</code>
<code> [9]           r,←nl,'Operators:'</code>
<code> [10]          r,←⊃,/nl,¨'  '∘,¨((1+verbose)⊃'name' 'syntax')Get bool/buffer</code>
<code> [11]      :EndIf</code>
<code> [12]  :EndIf</code>
</div>
<code class="header" id="listing_94">#.ADOC.ADOC.ADOC.CreateBrowseDefaults &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  ps←CreateBrowseDefaults</code>
<code> [1]      ⍝ Creates a namespace and populates it with default values for the `Browse` method.</code>
<code> [2]      ⍝ The result namespace can then be passed as left argument to `ADOC.Browse`.</code>
<code> [3]   :Access Public Shared</code>
<code> [4]   ps←⎕NS''</code>
<code> [5]   ps.BrowserPath←_BrowserPath</code>
<code> [6]   ps.embeddedClassesFlag←0</code>
<code> [7]   ps.IgnorePattern←_IgnorePattern</code>
<code> [8]   ps.Inherit←_Inherit</code>
<code> [9]   ps.ignoreCopyright←0</code>
<code> [10]  ps.ignoreHistory←0</code>
<code> [11]  ps.ignoreVersion←0</code>
<code> [12]  ps.SubTitles←''</code>
<code> [13]  ps.Title←_Title</code>
<code> [14]  ps.Toc←_Toc</code>
<code> [15]  ps.IncludeReference←_IncludeReference</code>
<code> [16]  ps.Filename←''</code>
<code> [17]  ps.view←1</code>
<code> [18]  ps.⎕FX'r←∆List;⎕IO' '⍝ List all variables and possible references in this namespace' '⎕IO←1' 'r←{⍵,[1.5]⍎¨⍵}⎕NL-2 9'</code>
</div>
<code class="header" id="listing_95">#.ADOC.ADOC.ADOC.Copyright &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Copyright</code>
<code> [1]      ⍝ Returns a copyright notice regarding `ADOC`.</code>
<code> [2]   :Access Public Shared</code>
<code> [3]   ⎕IO←1</code>
<code> [4]   r←''</code>
<code> [5]   r,←⊂'This source code is provided to you "as is" without warranties or '</code>
<code> [6]   r,←⊂'conditions of any kind, whether expressed or implied. Your use of '</code>
<code> [7]   r,←⊂'the source code is entirely at your own risk. Should the software '</code>
<code> [8]   r,←⊂'prove defective, you assume the entire cost of all service, repair '</code>
<code> [9]   r,←⊂'or correction.'</code>
<code> [10]  r←,[1.5]r</code>
</div>
<code class="header" id="listing_96">#.ADOC.ADOC.ADOC.SortPublicStuff &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> data←SortPublicStuff data</code>
<code> [1]     ⍝ Needed because the types should be sorted together but with the introduction of namespaces</code>
<code> [2]     ⍝ a dfn or an operator might be in the wrong place. We enforce a proper sequence here.</code>
<code> [3]  v1←'Include' 'Constructor' 'Destructor' 'Property' 'Field' 'Variable' 'Method' 'Function' 'Operator' 'Interface Method'</code>
<code> [4]  v2←'Inc' 'Con' 'Des' 'Prp' 'Fld' 'Var' 'Met' 'Fun' 'Opr' 'Int'</code>
<code> [5]  :If 1&lt;≢data</code>
<code> [6]      data←data[⍋v2⍳v2[v1⍳'type'Get data]]</code>
<code> [7]  :EndIf</code>
</div>
<code class="header" id="listing_97">#.ADOC.ADOC.ADOC.ListDfnsAndDops &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> vs←vs ListDfnsAndDops scriptRef</code>
<code> [1]     ⍝ Looks for dfns and dops but only if its a namespace rather than a class or interface.</code>
<code> [2]  :If vs.isNamespace</code>
<code> [3]      vs←ListCurly scriptRef vs 3.2 'Function'</code>
<code> [4]      vs←ListCurly scriptRef vs 4.2 'Operator'</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_98">#.ADOC.ADOC.ADOC.ListCurly &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> vs←ListCurly(ref vs class type)</code>
<code> [1]  :If 0≠≢list←' '~¨⍨↓ref.⎕NL class</code>
<code> [2]      :If 3=ref.⎕NC'Public'</code>
<code> [3]      :AndIf 0≠≢public←scriptRef.Public</code>
<code> [4]          list←(list∊public)/list</code>
<code> [5]      :EndIf</code>
<code> [6]  :AndIf 0≠≢list</code>
<code> [7]      vs.publishedStuff,←(⊂ref type)BuildPublishMatrix¨list</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_99">#.ADOC.ADOC.ADOC.ListVariables &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ListVariables(scriptRef whatsPublic)</code>
<code> [1]     ⍝ `whatsPublic` is empty in case it is not a namespace. Otherwise it is a list of names</code>
<code> [2]     ⍝ that are considered public in that namespace. Variables not listed are therefore private.</code>
<code> [3]  r←''</code>
<code> [4]  :If 0≠≢whatsPublic</code>
<code> [5]  :AndIf 0≠≢list←' '~¨⍨↓scriptRef.⎕NL 2</code>
<code> [6]  :AndIf 0≠≢list←(list∊whatsPublic)/list</code>
<code> [7]      r←LoopOverVars scriptRef(list~⊂'ADOC_Doc')</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_100">#.ADOC.ADOC.ADOC.LoopOverVars &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←LoopOverVars(scriptRef list)</code>
<code> [1]   r←''</code>
<code> [2]   :For vars :In list</code>
<code> [3]       buff←0 2⍴''</code>
<code> [4]       data←scriptRef.⍎vars</code>
<code> [5]       buff⍪←'type' 'Variable'</code>
<code> [6]       buff⍪←'access' 'shared'</code>
<code> [7]       buff⍪←'name'vars</code>
<code> [8]       more←⊂'Depth=',(⍕≡data),'; rank=',(⍕⍴⍴data),'; shape=',({0=≢⍵:'empty' ⋄ ⍕⍵}⍴data),'; type=',(⍕⎕DR data)</code>
<code> [9]       :If 0=≡data  ⍝ Scalar</code>
<code> [10]          more,←⊂'Data: ',{' '=1↑0⍴⍵:'''',⍵,'''' ⋄ ⍕⍵}data</code>
<code> [11]      :ElseIf 1=⍴⍴data</code>
<code> [12]      :AndIf 1≡≡data</code>
<code> [13]          :Trap 16    ⍝ If that crashes with a NONCE ERROR then it is most likely a reference!</code>
<code> [14]              more,←⊂'Data: ',RestrictVectorLength{' '=1↑0⍴⍵:'''',⍵,'''' ⋄ ⍕⍵}data</code>
<code> [15]          :EndTrap</code>
<code> [16]      :EndIf</code>
<code> [17]      buff⍪←'more'more</code>
<code> [18]      buff⍪←'comments'(GetVarsComment scriptRef vars)</code>
<code> [19]      r,←⊂buff</code>
<code> [20]  :EndFor</code>
</div>
<code class="header" id="listing_101">#.ADOC.ADOC.ADOC.LoopOverHeader &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> vs←vs LoopOverHeader chapterNo</code>
<code> [1]  :For i :In ⍳≢vs.header</code>
<code> [2]      (cmd txt)←i⊃vs.header</code>
<code> [3]      :If 'Txt'≡cmd</code>
<code> [4]          vs.Top,←PolishComments txt vs.hasContainers vs.isContainer chapterNo</code>
<code> [5]      :EndIf</code>
<code> [6]  :EndFor</code>
</div>
<code class="header" id="listing_102">#.ADOC.ADOC.ADOC.CreateHTML_ForVars &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateHTML_ForVars(data chapterNo)</code>
<code> [1]   Body←''</code>
<code> [2]   firstVars←vs.firstVars</code>
<code> [3]   :If firstVars</code>
<code> [4]       type←(GetSingle data),'s'</code>
<code> [5]       Body,←{(MakeBookmark ⍵),('h4 id="',GetChapterNo,':sharedvariables"')tag ⍵}'Shared',' ',type</code>
<code> [6]       Body,←PrepareSubLinks vs.publicStuff'Variable'vs.formattedScriptName</code>
<code> [7]       firstVars←0</code>
<code> [8]   :EndIf</code>
<code> [9]   Body,←vs.topRef,({(MakeBookmark ⍵),('h5 class="aplname" id="',GetChapterNo,':',('name'GetSingle data),'"')tag ⍵}('name'GetSingle data)),nl</code>
<code> [10]  Body,←PolishMore'more'GetSingle data</code>
<code> [11]  Body,←PolishComments('comments'GetSingle data)0 0 chapterNo</code>
<code> [12]  vs.firstVars←firstVars</code>
<code> [13]  vs.Body,←Body</code>
</div>
<code class="header" id="listing_103">#.ADOC.ADOC.ADOC.CreateHTML_ForMethodAndFunction &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateHTML_ForMethodAndFunction(data chapterNo)</code>
<code> [1]   Body←''</code>
<code> [2]   firstInstanceMethod←vs.firstInstanceMethod</code>
<code> [3]   firstSharedMethod←vs.firstSharedMethod</code>
<code> [4]   methodType←'access'GetSingle data</code>
<code> [5]   :If 'Instance'≡methodType</code>
<code> [6]       :If firstInstanceMethod</code>
<code> [7]           type←(GetSingle data),'s'</code>
<code> [8]           Body,←{(MakeBookmark ⍵),('h4 id="',GetChapterNo,':',(⎕C methodType),'methods"')tag ⍵}methodType,' ',type</code>
<code> [9]           Body,←methodType PrepareSubLinks vs.publicStuff type vs.formattedScriptName</code>
<code> [10]          firstInstanceMethod←0</code>
<code> [11]      :EndIf</code>
<code> [12]  :ElseIf 'Shared'≡methodType</code>
<code> [13]      :If firstSharedMethod</code>
<code> [14]          type←(GetSingle data),'s'</code>
<code> [15]          Body,←{(MakeBookmark ⍵),('h4 id="',GetChapterNo,':',(⎕C methodType),'methods"')tag ⍵}methodType,' ',type</code>
<code> [16]          Body,←methodType PrepareSubLinks vs.publicStuff methodType vs.formattedScriptName</code>
<code> [17]          firstSharedMethod←0</code>
<code> [18]      :EndIf</code>
<code> [19]  :EndIf</code>
<code> [20]  Body,←vs.topRef,({(MakeBookmark ⍵),('h5 class="aplname" id="',GetChapterNo,':',('name'GetSingle data),'"')tag ⍵}('name'GetSingle data))</code>
<code> [21]  Body,←SyntaxHelper'syntax'GetSingle data</code>
<code> [22]  :If 0≠≢'more'GetSingle data</code>
<code> [23]      Body,←PolishMore'more'GetSingle data</code>
<code> [24]  :EndIf</code>
<code> [25]  :If 0≠≢'comments'GetSingle data</code>
<code> [26]      Body,←1 PolishComments('comments'GetSingle data)0 0 chapterNo</code>
<code> [27]  :EndIf</code>
<code> [28]  vs.Body,←Body</code>
<code> [29]  vs.firstInstanceMethod←firstInstanceMethod</code>
<code> [30]  vs.firstSharedMethod←firstSharedMethod</code>
</div>
<code class="header" id="listing_104">#.ADOC.ADOC.ADOC.CreateHTML_ForInclude &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←CreateHTML_ForInclude vs</code>
<code> [1]   Body←''</code>
<code> [2]   firstIncludes←vs.firstIncludes</code>
<code> [3]   :If firstIncludes</code>
<code> [4]       Body,←(MakeBookmark'Included'),('h4 id="',GetChapterNo,':incl"')tag'Included'</code>
<code> [5]       firstIncludes←0</code>
<code> [6]       buffer←'name'∘GetSingle¨{⍵↑⍨+/∧\{'Include'≡↑⍵[1;2]}¨⍵}vs.publicStuff</code>
<code> [7]       Body,←nl,('ul'tag 1↓↑,/nl∘,¨'li'∘tag¨'code'∘tag¨buffer),nl</code>
<code> [8]   :EndIf</code>
<code> [9]   vs.Body,←Body</code>
<code> [10]  vs.firstIncludes←firstIncludes</code>
</div>
<code class="header" id="listing_105">#.ADOC.ADOC.ADOC.CreateHTML_ForConstructor &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←vs CreateHTML_ForConstructor(data chapterNo)</code>
<code> [1]   Body←''</code>
<code> [2]   firstConstructor←vs.firstConstructor</code>
<code> [3]   :If firstConstructor</code>
<code> [4]       Body,←{(MakeBookmark ⍵),('h4 id="',GetChapterNo,':ctor"')tag ⍵}'Constructor',(1&lt;+/'Constructor'∘≡¨Get vs.publicStuff/⍨2=↑∘⍴∘⍴¨vs.publicStuff)/'s'</code>
<code> [5]       firstConstructor←0</code>
<code> [6]   :EndIf</code>
<code> [7]   Body,←{((MakeBookmark ⍵)),'h5 class="aplname"'tag ⍵}'name'GetSingle data</code>
<code> [8]   Body,←SyntaxHelper'syntax'GetSingle data</code>
<code> [9]   :If 0≠≢2⊃data[data[;1]⍳⊂'comments';]</code>
<code> [10]      Body,←PolishComments('comments'GetSingle data)0 0 chapterNo</code>
<code> [11]  :EndIf</code>
<code> [12]  vs.Body,←Body</code>
<code> [13]  vs.firstConstructor←firstConstructor</code>
</div>
<code class="header" id="listing_106">#.ADOC.ADOC.ADOC.SortMethods &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←type SortMethods data</code>
<code> [1]        ⍝ Sort the methods in "data" alphabetically. "type" is one of: Instance, Shared or Public (Interface!)</code>
<code> [2]   :If 0≠≢r←data</code>
<code> [3]       bool←2=↑∘⍴∘⍴¨data</code>
<code> [4]   :AndIf 1∊bool←bool\'Method'∘≡¨Get bool/data</code>
<code> [5]       :If 0&lt;+/bool←bool\type∘≡¨'access'Get bool/data</code>
<code> [6]           buffer←bool/r</code>
<code> [7]           buffer←{⍵[SortAlphabet⍋⊃'name'Get buffer]}buffer</code>
<code> [8]           (bool/r)←buffer</code>
<code> [9]       :EndIf</code>
<code> [10]  :EndIf</code>
</div>
<code class="header" id="listing_107">#.ADOC.ADOC.ADOC.Sort &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←type Sort data</code>
<code> [1]       ⍝ Sort "type" in "data" alphabetically. "type" is one of: Property, Field</code>
<code> [2]  :If 0≠≢r←data</code>
<code> [3]      bool←2=↑∘⍴∘⍴¨r</code>
<code> [4]      bool←bool\type∘≡¨Get bool/r</code>
<code> [5]  :AndIf 0≠≢buffer←bool/r</code>
<code> [6]      buffer←{⍵[SortAlphabet⍋⊃'name'Get buffer]}buffer</code>
<code> [7]      (bool/r)←buffer</code>
<code> [8]  :EndIf</code>
</div>
<code class="header" id="listing_108">#.ADOC.ADOC.ADOC.SplitAtLamp &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (prop remark)←SplitAtLamp data</code>
<code> [1]         ⍝ Split "data" not only at the lamp (easy) but takes text into account, too.</code>
<code> [2]         ⍝ So this   :'foo←''⍝''  ⍝ assign lamp&lt;br&gt;    is handled correctly, too.</code>
<code> [3]   remark←''</code>
<code> [4]   (firstLine data)←{(1⊃⍵)(1↓⍵)}data</code>
<code> [5]   data←(':'≠↑¨data~¨' ')/data ⍝ remove lines like ":Access" and similars</code>
<code> [6]   :If '⍝'∊firstLine/⍨bool←~MaskText firstLine</code>
<code> [7]       (prop remark)←firstLine{((⍵-1)↑⍺)({⍵↓⍨+/∧\' '=⍵}⍵↓⍺)}'⍝'⍳⍨bool\bool/firstLine</code>
<code> [8]       prop←{⍵↓⍨+/∧\' '=⍵}({⍵↓⍨⍵⍳' '}prop)</code>
<code> [9]   :Else</code>
<code> [10]      prop←firstLine</code>
<code> [11]  :EndIf</code>
<code> [12]  :If 0≠≢data←({∧\'⍝'=↑⍵~' '}¨data)/data</code>
<code> [13]      remark←{⍵/⍨0&lt;↑∘⍴¨,¨⍵}(⊂remark),data</code>
<code> [14]  :EndIf</code>
<code> [15]  remark←{0 1∊⍨≡⍵:⊂⍵ ⋄ ⍵}remark</code>
<code> [16]  remark←{⍵↓⍨+/∧\⍵∊' ⍝'}¨remark</code>
</div>
<code class="header" id="listing_109">#.ADOC.ADOC.ADOC.GetTempFileName &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> R←GetTempFileName</code>
<code> [1]     ⍝ Returns a fully qualified temporary filename</code>
<code> [2]  R←P.FilesAndDirs.GetTempFilename''</code>
</div>
<code class="header" id="listing_110">#.ADOC.ADOC.ADOC.ReplaceDoubleBackslashByNewLine &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←ReplaceDoubleBackslashByNewLine markdown</code>
<code> [1]  preMask←~{⍵∨≠\⍵}{0&lt;↑⍴'^&lt;pre\b[^&gt;]*&gt;' '^&lt;/pre&gt;'⎕S 0⍠('Greedy' 0)⊣⍵}¨markdown</code>
<code> [2]  fenceMask←preMask\~{⍵∨≠\⍵}{0&lt;↑⍴'\s?~~~' '\s?```'⎕S 0⍠('Greedy' 0)⊢⍵}¨preMask/markdown</code>
<code> [3]  bool←preMask∧fenceMask</code>
<code> [4]  (bool/markdown)←P.APLTreeUtils2.DTB bool/markdown</code>
<code> [5]  (bool/markdown)←{'\\'≢¯2↑⍵:⍵ ⋄ (¯2↓⍵),⎕UCS 13}¨bool/markdown</code>
<code> [6]  r←(⎕UCS 13)P.APLTreeUtils2.Split 1↓↑,/(⎕UCS 13),¨markdown</code>
</div>
<code class="header" id="listing_111">#.ADOC.ADOC.ADOC.PolishMore &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←PolishMore data</code>
<code> [1]          ⍝ Make the "more" data ready for use - if any</code>
<code> [2]  r←⊃,/{('&lt;p&gt;',⍵,'&lt;/p&gt;'),nl}¨data</code>
</div>
<code class="header" id="listing_112">#.ADOC.ADOC.ADOC.AnalyzeHeader &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←AnalyzeHeader(ref header)</code>
<code> [1]  r←⍬</code>
<code> [2]  :If 0≠≢∊header</code>
<code> [3]      bool←'⍝⍝'∘≢¨2↑¨header</code>
<code> [4]      txt←2↓¨bool/header</code>
<code> [5]      r,←⊂'Txt'txt</code>
<code> [6]  :EndIf</code>
</div>
<code class="header" id="listing_113">#.ADOC.ADOC.ADOC.LookOutForSpecialFunctions &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> header←LookOutForSpecialFunctions(ref header)</code>
<code> [1]     ⍝ Analyze special fuunctions</code>
<code> [2]  header←HandleVersionInHeader ref header</code>
<code> [3]  header←HandleCopyRightInHeader ref header</code>
<code> [4]  header←HandleHistoryInHeader ref header</code>
</div>
<code class="header" id="listing_114">#.ADOC.ADOC.ADOC.AnalyzeField &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←AnalyzeField(noOf source masked)</code>
<code> [1]   r←⍬</code>
<code> [2]   :If ∨/' public '⍷↑masked</code>
<code> [3]       buffer←' 'P.APLTreeUtils2.Split P.APLTreeUtils2.DMB 1⊃source</code>
<code> [4]       type←⊃('Instance' 'Shared')[1+'shared'≡⎕C 3⊃buffer]</code>
<code> [5]       :If ∨/'⍝'∊¨(1⊃source)/⍨bool←~MaskText 1⊃source</code>
<code> [6]           (buffer remarks)←(1⊃source){((⍵-1)↑⍺)({⍵↓⍨+/∧\' '=⍵}⍵↓⍺)}'⍝'⍳⍨bool\bool/1⊃source</code>
<code> [7]           remarks←{2=≡⍵:⍵ ⋄ ⊂⍵}remarks</code>
<code> [8]           remarks,←{⍵↓⍨1+⍵⍳'⍝'}¨1↓source</code>
<code> [9]           buffer←' 'P.APLTreeUtils2.Split buffer</code>
<code> [10]      :Else</code>
<code> [11]          remarks←''</code>
<code> [12]      :EndIf</code>
<code> [13]      buffer←P.APLTreeUtils2.DLB⊃,/' ',¨buffer/⍨~(⎕C buffer)∊':field' 'public' 'instance' 'shared' 'readonly'</code>
<code> [14]      :If IgnorePattern{0=≢⍺:1 ⋄ ⍺∨.≠(≢⍺)↑⍵}buffer</code>
<code> [15]          name←buffer↑⍨¯1+buffer⍳'←'</code>
<code> [16]          :If _ignoreCopyright∨name≢'Copyright'</code>
<code> [17]          :AndIf _ignoreVersion∨name≢'Version'</code>
<code> [18]          :AndIf _ignoreHistory∨name≢'History'</code>
<code> [19]              r←⊃('type' 'Field')('name'name)('syntax'(buffer↓⍨buffer⍳'←'))('access'type)('comments'remarks)('more' '')('readonly'(∨/' readonly '⍷⎕C' ',source,' '))</code>
<code> [20]          :EndIf</code>
<code> [21]      :EndIf</code>
<code> [22]  :EndIf</code>
</div>
<code class="header" id="listing_115">#.ADOC.ADOC.ADOC.LoopOverSource &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←LoopOverSource(scriptRef vs)</code>
<code> [1]      ⍝ Analyzes `origSource` until it's all consumed.</code>
<code> [2]      ⍝ Looks for trad-fns, trad-opr, included stuff, fields, properties and classes.</code>
<code> [3]   buffer←''</code>
<code> [4]   :Repeat</code>
<code> [5]       noOf←1</code>
<code> [6]       :If 0≠≢currentline←1⊃vs.maskedSource</code>
<code> [7]           this←GetNameFromHeader currentline</code>
<code> [8]           name←'∇'~⍨GetNameFromHeader↑vs.origSource</code>
<code> [9]           :If '∇'∊this   ⍝ Is it a function, or an operator in case of a scripted namespace?</code>
<code> [10]              noOf←≢(1+'∇'⍳⍨↑¨' '~¨⍨1↓vs.origSource)↑vs.origSource</code>
<code> [11]              :If ignoreVersion∨'Version'≢name</code>
<code> [12]              :AndIf ignoreCopyright∨'Copyright'≢name</code>
<code> [13]              :AndIf ignoreHistory∨'History'≢name</code>
<code> [14]              :AndIf 'ADOC_Doc'≢(↑vs.origSource)~'∇ '  ⍝ Ignore `ADOC_Doc`</code>
<code> [15]                  buffer,←{0=≢⍵:'' ⋄ ⊂⍵}vs AnalyzeFns(scriptRef noOf)</code>
<code> [16]              :EndIf</code>
<code> [17]          :ElseIf ':'=↑this</code>
<code> [18]              :Select this</code>
<code> [19]              :Case ':include'</code>
<code> [20]                  buffer,←⊂⊃('type' 'Include')('access' '')('name'({⍵↑⍨¯1+⍵⍳' '}P.APLTreeUtils2.DLB{⍵↓⍨⍵⍳' '}1⊃vs.origSource))</code>
<code> [21]              :Case ':field'</code>
<code> [22]                  noOf←1++/∧\'⍝'=↑¨1↓P.APLTreeUtils2.DLB¨vs.origSource</code>
<code> [23]                  buffer,←{0=≢⍵:'' ⋄ ⊂⍵}AnalyzeField noOf,noOf↑¨vs.(origSource maskedSource)</code>
<code> [24]              :Case ':property'</code>
<code> [25]                  noOf←vs.maskedSource⍳⊂':endproperty'</code>
<code> [26]                  buffer,←{0=≢⍵:'' ⋄ ⊂⍵}AnalyzeProperty(noOf,noOf↑¨vs.(origSource maskedSource))</code>
<code> [27]              :Case ':class' ⍝ embedded class? Not of any interest to a user of a class</code>
<code> [28]                  noOf←≢':endclass'{⍵↑⍨1++/∧\((≢⍺)↑[2]⊃⍵)∨.≠⍺}vs.maskedSource</code>
<code> [29]              :Case ':endnamespace' ⍝ embedded namespace? Not of any interest to a user of a class</code>
<code> [30]                  noOf←≢':endnamespace'{⍵↑⍨1++/∧\((≢⍺)↑[2]⊃⍵)∨.≠⍺}vs.maskedSource</code>
<code> [31]              :EndSelect</code>
<code> [32]          :Else</code>
<code> [33]              :If '{'=1↑(≢this)↓1⊃vs.origSource ⍝ is it a dynamic function?</code>
<code> [34]                  noOf←FindEndOfDfns vs.maskedSource</code>
<code> [35]              :Else</code>
<code> [36]                  noOf←1⌈+/∧\'∆:'∊⍨↑¨vs.origSource</code>
<code> [37]              :EndIf</code>
<code> [38]          :EndIf</code>
<code> [39]      :EndIf</code>
<code> [40]      vs.(origSource maskedSource)←noOf↓¨vs.(origSource maskedSource)</code>
<code> [41]  :Until 0=≢vs.origSource</code>
<code> [42]  vs.publishedStuff,←buffer</code>
</div>
<code class="header" id="listing_116">#.ADOC.ADOC.ADOC.AnalyzeResult &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  data←AnalyzeResult data</code>
<code> [1]        ⍝ Re-order the array</code>
<code> [2]   :If 0≠≢data</code>
<code> [3]       data←data[⍋'Include' 'Constructor' 'Destructor' 'Interface' 'Property' 'Field' 'Method' 'Functions' 'Operators' 'Vars'⍳Get data]</code>
<code> [4]       data←'Instance'SortMethods data</code>
<code> [5]       data←'Shared'SortMethods data</code>
<code> [6]       data←'Public'SortMethods data</code>
<code> [7]       data←'Field'Sort data</code>
<code> [8]       data←'Property'Sort data</code>
<code> [9]       :If 0&lt;+/bool←2=↑∘⍴∘⍴¨data</code>
<code> [10]      :AndIf 0&lt;+/bool←bool\'Method'∘≡¨Get bool/data</code>
<code> [11]          (bool/data)←(bool/data)[⍋'Instance' 'Shared'⍳'access'Get bool/data]</code>
<code> [12]      :EndIf</code>
<code> [13]  :EndIf</code>
</div>
<code class="header" id="listing_117">#.ADOC.ADOC.ADOC.GetPublicDefinitionFrom_NS &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←GetPublicDefinitionFrom_NS(scriptRef vs)</code>
<code> [1]      ⍝ Only called when `scriptRef` points to a namespace.</code>
<code> [2]      ⍝ Returns either an empty vector (nothing is public) or a vector of</code>
<code> [3]      ⍝ text vectors with the names of the functions, operators and variables</code>
<code> [4]      ⍝ that are public.\\</code>
<code> [5]      ⍝ If there is a function `Public` then it rules the day. Otherwise</code>
<code> [6]      ⍝ **all** functions, operators and variables are considered public.\\</code>
<code> [7]   :If ':NAMESPACE '{⍺≡(≢⍺)↑⍵}1 ⎕C P.APLTreeUtils2.DLB 1⊃vs.origSource</code>
<code> [8]       :If 0=scriptRef.⎕NC'Public'</code>
<code> [9]           vs.public←' '~¨⍨↓scriptRef.⎕NL 3.1 4.1 2</code>
<code> [10]      :Else</code>
<code> [11]          buff←↓⍣(↑2=⍴⍴scriptRef.⍎'Public')⊣scriptRef.⍎'Public'</code>
<code> [12]          vs.public←scriptRef.{0=≢⍵:⍵ ⋄ ⍵/⍨3.1 3.2 4.1 4.2 2∊⍨↑∘⎕NC¨⊂¨⍵}buff</code>
<code> [13]      :EndIf</code>
<code> [14]  :EndIf</code>
<code> [15]  :If (⊂'Copyright')∊vs.public</code>
<code> [16]  :AndIf ~_ignoreCopyright</code>
<code> [17]      vs.public~←⊂'Copyright'</code>
<code> [18]  :EndIf</code>
<code> [19]  :If (⊂'Version')∊vs.public</code>
<code> [20]  :AndIf ~_ignoreVersion</code>
<code> [21]      vs.public~←⊂'Version'</code>
<code> [22]  :EndIf</code>
<code> [23]  :If (⊂'History')∊vs.public</code>
<code> [24]  :AndIf ~_ignoreHistory</code>
<code> [25]      vs.public~←⊂'History'</code>
<code> [26]  :EndIf</code>
</div>
<code class="header" id="listing_118">#.ADOC.ADOC.ADOC.GetNameFromHeader &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetNameFromHeader header</code>
<code> [1]   r←{⍵/⍨~{⍵∨≠\⍵}⍵∊'{}'}P.APLTreeUtils2.DMB header</code>
<code> [2]   :If '∇'∊r</code>
<code> [3]       r←{⍵↑⍨¯1+⍵⍳'⍝'}r                  ⍝ remove comments</code>
<code> [4]       r←P.APLTreeUtils2.DMB{⍵↑⍨¯1+⍵⍳';'}r   ⍝ remove local vars</code>
<code> [5]   :AndIf '∇'=↑P.APLTreeUtils2.DMB r</code>
<code> [6]       r←{'←'∊⍵:⍵↓⍨⍵⍳'←' ⋄ ⍵}r           ⍝ remove explicit result</code>
<code> [7]       rightArg←0</code>
<code> [8]       :If ')'=¯1↑r                      ⍝ Is there a parathesized right argument?</code>
<code> [9]           r←⌽{⍵↓⍨(⍵⍳'(')}⌽r             ⍝ remove parenthesized right argument</code>
<code> [10]          rightArg←1</code>
<code> [11]      :EndIf</code>
<code> [12]      :If '('∊r                         ⍝ Operator?!</code>
<code> [13]          r←1↓¯1↓r{⍺/⍨⍵∨≠\⍵}r∊'()'</code>
<code> [14]          r←{' 'P.APLTreeUtils2.Split P.APLTreeUtils2.DMB ⍵~'∇'}r       ⍝ split by blank, remove any dels first</code>
<code> [15]          r←'∇',2⊃r                     ⍝ With operators it's always the second one</code>
<code> [16]      :Else</code>
<code> [17]          r←{' 'P.APLTreeUtils2.Split P.APLTreeUtils2.DMB ⍵~'∇'}r       ⍝ split by blank, remove any dels first</code>
<code> [18]          r←'∇',{⍵⊃⍨(1(1+rightArg)2)[1 2 3⍳≢⍵]}r ⍝ 1=f ⋄ 2=f r ⋄ 3=(l f r)</code>
<code> [19]      :EndIf</code>
<code> [20]  :Else</code>
<code> [21]      r←{⍵↑⍨¯1+⍵⍳' '}r</code>
<code> [22]  :EndIf</code>
</div>
<code class="header" id="listing_119">#.ADOC.ADOC.ADOC.GetSyntax &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> syntax←GetSyntax header</code>
<code> [1]  syntax←P.APLTreeUtils2.DMB{⍵↑⍨¯1+⍵⍳';'}{⍵↓⍨+/∧\' '=⍵}'∇'~⍨header</code>
<code> [2]  syntax↑⍨←¯1+syntax⍳'⍝'</code>
<code> [3]  syntax←{~'}'∊⍵:⍵ ⋄ b←'}'=w←⍵ ⋄ (b/w)←⊂'} ' ⋄ ∊w}syntax</code>
<code> [4]  syntax←{~':'∊⍵:⍵ ⋄ ⍵↑⍨¯1+⍵⍳':'}syntax</code>
<code> [5]  syntax←{~'←'∊⍵:⍵ ⋄ b←'←'=w←⍵ ⋄ (b/w)←⊂' ← ' ⋄ ∊w}syntax</code>
<code> [6]  syntax←P.APLTreeUtils2.DMB syntax ⍝ { and ← in the same header results in "  "</code>
</div>
<code class="header" id="listing_120">#.ADOC.ADOC.ADOC.ProcessKeywords &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> keywords←ProcessKeywords data</code>
<code> [1]  keywords←'keywords'Get data</code>
<code> [2]  keywords←('readonly'Get data){⍺:(⊂'ReadOnly'),⍵ ⋄ ⍵}¨keywords</code>
<code> [3]  keywords←{⍵/⍨0&lt;≢¨⍵}¨keywords</code>
<code> [4]  keywords←{0=≢∊⍵:'' ⋄ 1=≢⍵:' (',(∊⍵),')' ⋄ ' (',(⊃{⍺,',',⍵}/⍵),')'}¨keywords</code>
</div>
<code class="header" id="listing_121">#.ADOC.ADOC.ADOC.GetPrintCss &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetPrintCss</code>
<code> [1]   :Access Public Shared</code>
<code> [2]      ⍝ Returns the CSS for printing purposes.</code>
<code> [3]   r←''</code>
<code> [4]   r,←⊂'html {font-family: "Verdana", "Arial"; font-size:9pt; margin:0; padding:0 6pt;}'</code>
<code> [5]   r,←⊂'html * {text-decoration: none;}'</code>
<code> [6]   r,←⊂'div.sublinks{margin:1em;}'</code>
<code> [7]   r,←⊂'ul, ol, p {margin-left:12pt; max-width:auto;}'</code>
<code> [8]   r,←⊂'p.aplname {font-family:"APL385 Unicode";}'</code>
<code> [9]   r,←⊂'div.header  {padding:0 ;margin: 0 0 2em 0;}'</code>
<code> [10]  r,←⊂'h2, h3 {margin-top:2pt; margin-bottom:0;}'</code>
<code> [11]  r,←⊂'h4,h5,h6 {margin-top:0; margin-bottom:0; padding-top:0; font-size:10pt;}'</code>
<code> [12]  r,←⊂'.goto, .sublinks {display:none;}'</code>
<code> [13]  r,←⊂'code, .aplinlinecode {font-family:"APL385 Unicode";}'</code>
<code> [14]  r,←⊂'#sep {padding-left:4em;}'</code>
<code> [15]  r,←⊂'pre {font-family:"APL385 Unicode"; margin: 6pt 0 6pt 8pt; padding:0; line-height:1.2; border: 1pt dotted silver; padding:6pt; background-color: #f0f0f0;}'</code>
<code> [16]  r,←⊂'li &gt; pre {margin-left: 0;}'</code>
<code> [17]  r,←⊂'div.aplcode {font-family:"APL385 Unicode"; font-size:120%; padding:3pt 0 3pt 7pt; margin:0;}'</code>
<code> [18]  r,←⊂'code {font-family:"APL385 Unicode", "Courier New", monospace; margin:0; padding:0; font-size:100%; display:inline; color: #950000;}'</code>
<code> [19]  r,←⊂'pre &gt; code {padding: 0; background-color: #f0f0f0;}'</code>
<code> [20]  r,←⊂'p.small {padding:0; margin:0 0 0 2em; font-size:7pt;}'</code>
<code> [21]  r,←⊂'li &gt; p {margin:8pt 0;}'</code>
<code> [22]  r,←⊂'h1, h2, h3, h4, h5, h6 {margin-left: 0pt;}'</code>
<code> [23]  r,←⊂'h1{text-align:center; padding:10pt; margin:1em 5pt 2em 5pt; width:100%; font-Size:16pt;}'</code>
<code> [24]  r,←⊂'h2 {font-size:11pt;}'</code>
<code> [25]  r,←⊂'h3 {font-size:10pt; margin:1em 0 0 0;}'</code>
<code> [26]  r,←⊂'h4 {font-size:9pt; padding:0; margin:2pt 0 0 0;}'</code>
<code> [27]  r,←⊂'h5 {font-size:8pt; padding:0; margin:2pt 0 0 0;}'</code>
<code> [28]  r,←⊂'h5.aplname {font-family:"APL385 Unicode"; font-size:120%; padding:5pt 0 3pt 7pt; margin:1em 0 0 0;}'</code>
<code> [29]  r,←⊂'#topmost {text-align:center; padding:10pt; margin:1em 5pt 2em 5pt; width:100%; font-Size:16pt;}'</code>
<code> [30]  r,←⊂'#toc {line-height:1.3; margin-left:1.5em; background-color: white}'</code>
<code> [31]  r,←⊂'#footer {text-align:center; font-size:7pt;}'</code>
<code> [32]  r,←⊂'#maintoc {margin:1em 1em 1em 4em; page-break-after:always}'</code>
<code> [33]  r,←⊂'#maintoc ol {margin:0 0 1em 0;}'</code>
<code> [34]  r,←⊂'#maintoc h1 {font-size:10pt; border:0; width:13em; margin:0; text-align:left;}'</code>
<code> [35]  r,←⊂'#maintoc div {margin-left:30pt;} '</code>
<code> [36]  r,←⊂'#maintoc div.subtoc {margin-left:40pt;}'</code>
<code> [37]  r,←⊂'ul, ol {padding-left: 10pt; margin: 10pt 0;}'</code>
<code> [38]  r,←⊂'li {margin-bottom:0.5em; line-height:1.2; margin-left:1.5em;}'</code>
<code> [39]  r,←⊂'div.toctab {display:none;}'</code>
<code> [40]  r,←⊂'a {text-decoration:none; color:black;}'</code>
<code> [41]  r,←⊂'a.autoheader_anchor {text-decoration:none;}'</code>
<code> [42]  r,←⊂'div.content {page-break-after:always;}'</code>
<code> [43]  r,←⊂'tr:nth-child(odd) {background: #eaeaea}'</code>
<code> [44]  r,←⊂'tr:nth-child(even) {background: #f3f3f3}'</code>
<code> [45]  r,←⊂'th, td {padding: 4px 6px; border: 1px solid silver;}'</code>
<code> [46]  r,←⊂'table {border-collapse: collapse; margin: 15px;}'</code>
</div>
<code class="header" id="listing_122">#.ADOC.ADOC.ADOC.GetScreenCss &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←GetScreenCss</code>
<code> [1]   :Access Public Shared</code>
<code> [2]      ⍝ Return the CSS for screen purposes.</code>
<code> [3]   r←''</code>
<code> [4]   r,←⊂'html {font-family: "DejaVu Sans","Noto Sans","Lucida Sans Unicode", Sans-Serif; background-color: #fffeea; font-size: medium; margin:0; padding:0; color:#4b4b4b;}'</code>
<code> [5]   r,←⊂'body {max-width:920px; margin-left: auto; margin-right: auto;}'</code>
<code> [6]   r,←⊂'div.sublinks{margin: 1em; }'</code>
<code> [7]   r,←⊂'div.header h2, h3 {margin-top: 10px; margin-bottom: 0;}'</code>
<code> [8]   r,←⊂'h2 {margin-top: 5px; margin-bottom: 0;}'</code>
<code> [9]   r,←⊂'h3 {margin-top: 5px; margin-bottom: 0;}'</code>
<code> [10]  r,←⊂'h4 {margin-top: 20px; margin-bottom: 0; padding-top:0;}'</code>
<code> [11]  r,←⊂'h5 {margin-top: 0  ; margin-bottom: 0; padding-top:0;}'</code>
<code> [12]  r,←⊂'h6 {margin-top: 5px; margin-bottom: -5px; padding-top:0;}'</code>
<code> [13]  r,←⊂'p {margin: 8px; font-size: medium; line-height: 1.2;}'</code>
<code> [14]  r,←⊂'p.aplname {font-family: "APL385 Unicode"; font-size: small; }'</code>
<code> [15]  r,←⊂'div.goto {float: right; margin:0; padding:0 0 0 1em; }'</code>
<code> [16]  r,←⊂'span.aplinlinecode, span.aplinlinecode a {font-family: "APL385 Unicode"; font-size: medium; color: ',InLineCodeColor,'; padding-left:',(⍕InLineCodePadding),'px;padding-right:',(⍕InLineCodePadding),'px;}'</code>
<code> [17]  r,←⊂'text.aplinlinecode {font-family: "APL385 Unicode"; font-size: medium; color: inherent;}'</code>
<code> [18]  r,←⊂'#sep {padding-left: 4em; }'</code>
<code> [19]  r,←⊂'pre {font-family: "APL385 Unicode"; margin: 1em 0 1em 8px; font-size:medium; padding:3px; line-height: 1.2;'</code>
<code> [20]  r,←⊂'     overflow:auto; word-break:normal !important; word-wrap:normal !important; white-space: pre !important;'</code>
<code> [21]  r,←⊂'     border: 2pt dotted silver; background-color: #ebf1fa;}'</code>
<code> [22]  r,←⊂'li &gt; pre {margin-left: 0;}'</code>
<code> [23]  r,←⊂'div.aplcode {font-family: "APL385 Unicode"; font-size: 110%; padding: 2px 0px 2px 5px; color:inherent; border: 1px solid silver; '</code>
<code> [24]  r,←⊂'     background-color:inherent; margin: 5px 0 0 10px; }'</code>
<code> [25]  r,←⊂'code {font-family: "APL385 Unicode", "Courier New", Monospace; margin: 0 1px; padding: 2px 2px 2px 2px; color:inherent; font-size: 100%; display:inline; color:#950000;}'</code>
<code> [26]  r,←⊂'pre &gt; code {padding: 0;}'</code>
<code> [27]  r,←⊂'p.small {padding:0; margin:0 0 0 2em; }'</code>
<code> [28]  r,←⊂'li &gt; p {margin:8px 0;}'</code>
<code> [29]  r,←⊂'h1, h2, h3, h4, h5, h6 {color:#97721b; margin-left: 10px; }'</code>
<code> [30]  r,←⊂'h6 {font-size: 100%;}'</code>
<code> [31]  r,←⊂'h1{Background-Color: #dedede; text-align: center; padding: 10px 0; margin: 5px 0; font-Size: 150%; border: 1px solid black; }'</code>
<code> [32]  r,←⊂'h2 {font-Size: 140%;}'</code>
<code> [33]  r,←⊂'h3 {font-size: 130%;  padding-top: 0em;}'</code>
<code> [34]  r,←⊂'h4 {font-size: 120%;  padding-top: 0em;}'</code>
<code> [35]  r,←⊂'h5 {font-size: 110%;  padding-top: 0em;}'</code>
<code> [36]  r,←⊂'h5.aplname {font-family: "APL385 Unicode"; font-size: 120%; padding: 0.5em 5px 0 5px; margin: 0.5em 0 0 0; }'</code>
<code> [37]  r,←⊂'h1#topmost {Background-Color: #dedede; text-align: center; padding: 5px 0; margin: 0 0; font-Size: 160%; border: 2px solid black; }'</code>
<code> [38]  r,←⊂'ol#toc {font-size: small; line-height: 1.3; }'</code>
<code> [39]  r,←⊂'#toc {font-size: small; line-height: 1.3; margin-left:1em; margin-bottom:1em;}'</code>
<code> [40]  r,←⊂'toc &gt; a::before {content:"";}'</code>
<code> [41]  r,←⊂'toc &gt; a {text-decoration:underline}'</code>
<code> [42]  r,←⊂'#footer {text-align: center; font-size: small; color:inherent; }'</code>
<code> [43]  r,←⊂'#maintoc {width: 40em; border: 1px solid black; margin: 1em;font-size: small; line-height: 1.15; }'</code>
<code> [44]  r,←⊂'#maintoc &gt; div {margin-left:1.5em; margin-top:5px;}'</code>
<code> [45]  r,←⊂'#maintoc ol {margin:0 0 1em 0; }'</code>
<code> [46]  r,←⊂'#maintoc h1 {font-size:medium; background-color:transparent; border:0; color:inherent; width: 13em; margin: 0; text-align: left;}'</code>
<code> [47]  r,←⊂'#maintoc div.subtoc {margin-left:3em;}'</code>
<code> [48]  r,←⊂'ul, ol {padding-left: 20px ; margin: 10px 0; }'</code>
<code> [49]  r,←⊂'li { margin-bottom:0.5em; margin-left:1em; line-height:1.1;}'</code>
<code> [50]  r,←⊂'div.toctab {font-size: small; line-height: 1.4em; border: 1px solid silver; float:right; margin: 0.5em 0 0.5em 0.5em; padding:0.75em; '</code>
<code> [51]  r,←⊂'           background-color:white; line-height:1.6; }'</code>
<code> [52]  r,←⊂'div.level2 {padding-left: 0em;}'</code>
<code> [53]  r,←⊂'div.level3 {padding-left: 1em;}'</code>
<code> [54]  r,←⊂'div.level4 {padding-left: 2.5em;}'</code>
<code> [55]  r,←⊂'div.level5 {padding-left: 3em;}'</code>
<code> [56]  r,←⊂'div.level6 {padding-left: 3.56em;}'</code>
<code> [57]  r,←⊂'thead &gt; tr:nth-child(odd) {background: #dedede;}'</code>
<code> [58]  r,←⊂'tbody &gt; tr:nth-child(odd)  {background: #eaeaea;}'</code>
<code> [59]  r,←⊂'tbody &gt; tr:nth-child(even) {background: #f5f5f5;}'</code>
<code> [60]  r,←⊂'th, td {padding: 4px 6px; border: 1px solid silver; vertical-align: top;}'</code>
<code> [61]  r,←⊂'table {border-collapse: collapse; margin: 1em 1.8em 0.5em 1.8em; background-color:grey;}'</code>
<code> [62]  r,←⊂'a.autoheader_anchor {text-decoration:none;}'</code>
</div>
<code class="header" id="listing_123">#.ADOC.ADOC.ADOC.FindEndOfDfns &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←FindEndOfDfns source</code>
<code> [1]   r←0</code>
<code> [2]   noOfOpeneded←noOfClosed←0</code>
<code> [3]   :For this :In source</code>
<code> [4]       noOfOpeneded+←+/'{'=this</code>
<code> [5]       noOfClosed+←+/'}'=this</code>
<code> [6]       r+←1</code>
<code> [7]       :If noOfOpeneded=noOfClosed</code>
<code> [8]           :Leave</code>
<code> [9]       :EndIf</code>
<code> [10]  :EndFor</code>
<code> [11]       ⍝ Done</code>
</div>
<code class="header" id="listing_124">#.ADOC.ADOC.ADOC.MergeWithDevisor &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←MergeWithDevisor devisor</code>
<code> [1]        ⍝ Implicit argument: _META; is also modified</code>
<code> [2]   currentMeta←(≢_META)⊃_META</code>
<code> [3]   scriptName←1 1⊃devisor</code>
<code> [4]   type←1 2⊃devisor</code>
<code> [5]   r←''</code>
<code> [6]   :If 0≠≢buffer←5⊃currentMeta</code>
<code> [7]       nameList←'name'∘Get 5⊃currentMeta</code>
<code> [8]       :For i :In ⍳⍴1 5⊃devisor</code>
<code> [9]           this←i⊃1 5⊃devisor</code>
<code> [10]          name←'name'GetSingle this</code>
<code> [11]          :If (⊂name)∊nameList</code>
<code> [12]              this←Set this'more'(⊂'Inherited from "',scriptName,'" but re-defined')</code>
<code> [13]              (1 5 i⊃devisor)←this</code>
<code> [14]          :Else</code>
<code> [15]              this←Set this'more'(⊂'Inherited from "',scriptName,'"')</code>
<code> [16]              (5⊃currentMeta)←(5⊃currentMeta),⊂this</code>
<code> [17]          :EndIf</code>
<code> [18]      :EndFor</code>
<code> [19]      (5⊃currentMeta)←AnalyzeResult 5⊃currentMeta</code>
<code> [20]      ((≢_META)⊃_META)←currentMeta</code>
<code> [21]  :EndIf</code>
</div>
<code class="header" id="listing_125">#.ADOC.ADOC.ADOC.GetVarsFrom &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetVarsFrom spaceRef</code>
<code> [1]  :With spaceRef</code>
<code> [2]      r←{⍵(⍎⍵)}¨⎕NL-2 9</code>
<code> [3]  :EndWith</code>
<code> [4]  r←⊃¨{IsChar ⍵:'_',⍺,'←''',⍵,'''' ⋄ '_',⍺,'←',⍕⍵}/¨r</code>
</div>
<code class="header" id="listing_126">#.ADOC.ADOC.ADOC.InsertChapterToc &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  vs←InsertChapterToc vs</code>
<code> [1]       ⍝ Inserts anchors to all "leading" &lt;h{n}&gt; tags and prepares a table-of-contents</code>
<code> [2]       ⍝ although this might be visible only if a certain number of entries is found.</code>
<code> [3]       ⍝ Adds to vs.Top</code>
<code> [4]   :If _Toc</code>
<code> [5]       Toc←⊂'&lt;div class="toctab"&gt;'</code>
<code> [6]       :If 0&lt;≢vs.Top</code>
<code> [7]       :AndIf 0&lt;+/bool←(⍳≢vs.Top)∊1+'&lt;h[0-9]\b[^&gt;]*&gt;'⎕S 0⍠('Mode' 'D')⊣vs.Top</code>
<code> [8]           level1Flag←0≠≢'&lt;h1\b[^&gt;]*&gt;'⎕S 0⍠('Mode' 'D')⊣vs.Top</code>
<code> [9]           vs.Top←(1,1↓bool){⎕ML←0 ⋄ ⍺⊂⍵}vs.Top</code>
<code> [10]          (First vs.Top)←{(1⊃⍵)(1↓⍵)}vs.Top</code>
<code> [11]          :For i :In ⍳≢vs.Top</code>
<code> [12]              this←i⊃vs.Top</code>
<code> [13]              no←⍎this[3]</code>
<code> [14]              anchor←'toc_',GetChapterNo,':',¯4↑'0000',⍕i</code>
<code> [15]              this[this⍳'&gt;']←⊂' id="',anchor,'"&gt;'</code>
<code> [16]              this←∊this</code>
<code> [17]              (i⊃vs.Top)←this</code>
<code> [18]              buffer←'&lt;div class="level',(⍕1⌈6⌊no),'"&gt;',nl</code>
<code> [19]              buffer,←'&lt;a href="#',anchor,'"&gt;',({⍵↑⍨¯1+⍸'&lt;/h'⍷⍵}{⍵↓⍨⍵⍳'&gt;'}this),'&lt;/a&gt;',nl,'&lt;/div&gt;'</code>
<code> [20]              Toc,←⊂buffer,nl</code>
<code> [21]          :EndFor</code>
<code> [22]          :If 0≠≢vs.topLinks</code>
<code> [23]              Toc,←'&lt;div class="level2"&gt;&lt;a href="#',GetChapterNo,'_tocref"&gt;Reference&lt;/a&gt;&lt;/div&gt;'</code>
<code> [24]              Toc,←{'&lt;div class="level3"&gt;',⍵,'&lt;/div&gt;'}¨vs.topLinks[;2]</code>
<code> [25]          :EndIf</code>
<code> [26]          Toc←{0=≢⍵:'' ⋄ ⊃,/⍵}Toc</code>
<code> [27]          vs.Top←(1⊃vs.Top),{0=≢⍵:'' ⋄ ⊃,/⍵}1↓vs.Top</code>
<code> [28]          :If level1Flag</code>
<code> [29]              vs.Top←First,Toc,'&lt;/div&gt;',vs.Top</code>
<code> [30]          :Else</code>
<code> [31]              vs.Top←{⍵,Toc,'&lt;/div&gt;',(≢⍵)↓First,vs.Top}'&lt;div class="header"&gt;'</code>
<code> [32]          :EndIf</code>
<code> [33]      :ElseIf 0≠≢vs.topLinks</code>
<code> [34]          Toc,←{'&lt;div class="level2"&gt;',⍵,'&lt;/div&gt;'}¨vs.topLinks[;2]</code>
<code> [35]          Toc,←'&lt;/div&gt;'</code>
<code> [36]          vs.Top,←'&lt;div id="',GetChapterNo,'_toc"&gt;',(⊃{0=≢⍵:'' ⋄ ⊃,/⍵}Toc),'&lt;/div&gt;'</code>
<code> [37]      :EndIf</code>
<code> [38]  :EndIf</code>
</div>
<code class="header" id="listing_127">#.ADOC.ADOC.ADOC.SortAlphabet &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←SortAlphabet</code>
<code> [1]  r←(⊃(' ',⎕A,⎕D)(' abcdefghijklmnopqrstuvwxyz',⎕D))</code>
</div>
<code class="header" id="listing_128">#.ADOC.ADOC.ADOC.GetChapterNo &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←GetChapterNo</code>
<code> [1]     ⍝ Relies on the existence of a semi-global "chapterNo"</code>
<code> [2]  r←'ch',¯4↑'0000',⍕chapterNo</code>
</div>
<code class="header" id="listing_129">#.ADOC.ADOC.ADOC.P &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←P</code>
<code> [1]     ⍝ Parent. Required because it might be called from an Instance, in which case a simple ##. won't do</code>
<code> [2]  r←(↑↑⎕CLASS ⎕THIS).##</code>
</div>
<code class="header" id="listing_130">#.ADOC.ADOC.ADOC.isRef &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_131">#.ADOC.ADOC.ADOC.embeddedClassNames &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_132">#.ADOC.ADOC.ADOC.addExt &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_133">#.ADOC.ADOC.ADOC.verbose &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_134">#.ADOC.ADOC.ADOC.convertHeader &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_135">#.ADOC.ADOC.ADOC.maxLength &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_136">#.ADOC.ADOC.ADOC.vs.Top &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_137">#.ADOC.ADOC.ADOC.append &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_138">#.ADOC.ADOC.ADOC.wait &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_139">#.ADOC.ADOC.ADOC.noSplit &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<div id="footer">
<hr>
<p>Created by "CodeCoverage" version 0.10.2+52 from 2023-04-09</p>
</div>

</body>
</html>
